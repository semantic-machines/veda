@prefix s-wfb: <http://semantic-machines.com/veda/simple-workflow-base/> .
@prefix : <http://semantic-machines.com/veda/simple-workflow/> .
@prefix s-wf: <http://semantic-machines.com/veda/simple-workflow/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix v-wf: <http://semantic-machines.com/veda/veda-workflow/> .
@prefix v-s: <http://semantic-machines.com/veda/veda-schema/> .
@prefix v-ui: <http://semantic-machines.com/veda/veda-ui/> .
@prefix td: <http://semantic-machines.com/veda/test-data/> .
@prefix d: <http://semantic-machines.com/veda/veda-data/>.
@prefix cfg: <http://semantic-machines.com/veda/config/> .

<http://semantic-machines.com/veda/simple-workflow>
  rdf:type owl:Ontology ;
  owl:imports <http://semantic-machines.com/veda/veda-workflow> ;
#  owl:versionInfo "1.3" ;
  rdfs:label "Simple workflow base ontology"@en ;
  rdfs:label "Онтология бизнес процессов базовая"@ru ;
  v-s:loadPriority 21 ;
.

# -----------------------------------------------

s-wf:var_initiator
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "initiator" ;
  rdfs:label "Инициатор"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_controller
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "controller" ;
  rdfs:label "Контролирующий"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_responsible
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "responsible" ;
  rdfs:label "Ответственный"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_rightset
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "rightset" ;
  rdfs:label "Права на документ"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_task_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "taskComment" ;
  rdfs:label "Комментарий к задаче"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_dateTo
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "taskDateTo" ;
  rdfs:label "Контрольный срок задачи"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_actor_task_add_to_date_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_add_to_date_to" ;
  rdfs:label "Количество дней к дате контрольного срока задачи"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_doc_id
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "docId" ;
  rdfs:label "Id документа"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_startForm_id
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "startForm_id" ;
  rdfs:label "Id стартовой формы"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_coordinator
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "coordinator" ;
  rdfs:label "Список согласующих"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_documentType
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "documentType" ;
  rdfs:label "тип документа"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor" ;
  rdfs:label "Исполнители"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_add_request_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "add_request_actor" ;
  rdfs:label "Исполнители дополнительного запроса"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_result_decision
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "result_decision" ;
  rdfs:label "Полученное решение пользователя"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_last_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "last_actor" ;
  rdfs:label "Last actor" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_decision_of_set_responsible
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_of_set_responsible" ;
  rdfs:label "Решение о назначении исполнителей"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_decision_form_type
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_form_type" ;
  rdfs:label "Decision form type"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_signer
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "signer" ;
  rdfs:label "Подписывающий"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_reviewer
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "reviewer" ;
  rdfs:label "Рассматривающий"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_right_1
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineScope v-wf:Net ;
  v-wf:varDefineName "originalRights" ;
  rdfs:label "Исходные права на документ"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_result
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineScope v-wf:Net ;
  v-wf:varDefineName "result" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_coordination_level
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "coordinationLevel" ;
  rdfs:label "Уровень согласования"@ru ;
.

s-wf:possible_decision
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "possible_decision" ;
  rdfs:label "Возможные варианты решения"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:decision_route_to_add_reaction
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_route_to_add_reaction" ;
  rdfs:label "Решение для перехода к дополнительной реакции пользователя"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:possible_decision_for_add_reaction
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "possible_decision_for_add_reaction" ;
  rdfs:label "Возможные дополнительные варианты решения"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

# --------------------------------

s-wf:map_possible_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision ;
  v-wf:mappingExpression  "process.getInputVariable ('possible_decision')" ;
.

s-wf:possible_decision_after_return
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision ;
  v-wf:mappingExpression  "[newUri('v-wf:DecisionAgreed'), newUri ('v-wf:DecisionRemake'), newUri('v-wf:DecisionRedirect')]" ;
.

s-wf:map_decision_route_to_add_reaction
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:decision_route_to_add_reaction ;
  v-wf:mappingExpression  "process.getInputVariable ('decision_route_to_add_reaction')" ;
.

s-wf:map_possible_decision_for_add_reaction
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision_for_add_reaction ;
  v-wf:mappingExpression  "process.getInputVariable ('possible_decision_for_add_reaction')" ;
.

s-wf:map_decision_of_set_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_of_set_responsible ;
  v-wf:mappingExpression  "task_result.getValue ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_result_decision_from_task_result
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression  "task_result.getValue ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.


s-wf:map_last_actor_4_TR_last_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_last_actor ;
  v-wf:mappingExpression  "task_result.getValue ('last_actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_4_PLV_last_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression  "process.getLocalVariable ('last_actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_get_rights
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_right_1 ;
  v-wf:mappingExpression  "task_result.getValue ('right')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_orig_rights
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_right_1 ;
  v-wf:mappingExpression  "process.getInputVariable ('originalRights')" ;
  rdfs:isDefinedBy s-wf: ;
.

#---------------------------------

s-wf:map_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression  "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_responsible ;
  v-wf:mappingExpression  "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_add_to_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_add_to_date_to ;
  v-wf:mappingExpression  "process.getInputVariable ('taskAddToDateTo')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_from_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_4_PLV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression  "process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_doc_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_doc_id ;
  v-wf:mappingExpression  "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_form_type_4_PLV_decision_form_type
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_form_type ;
  v-wf:mappingExpression  "process.getLocalVariable ('decision_form_type')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_form_type_4_PIV_decision_form_type
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_form_type ;
  v-wf:mappingExpression  "process.getInputVariable ('decision_form_type')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_action_4_PIV_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression  "process.getInputVariable ('actor_task_action')" ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "actor_task_action <- actor_task_action" ;
.

s-wf:map_coordinator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_coordinator ;
  v-wf:mappingExpression  "process.getInputVariable ('coordinator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_coord_level
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_coordination_level ;
  v-wf:mappingExpression  "process.getInputVariable ('coordinationLevel')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_project2_to_docId
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_doc_id ;
  v-wf:mappingExpression  "process.getLocalVariable ('project2')" ;
  rdfs:isDefinedBy s-wf: ;
.
#----

s-wf:executor_signer
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('signer')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:executor_initiator
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:executor_reviewer
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('reviewer')" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------- var + map : "Проверить, запущен ли?" ---------------- #

s-wf:var_result_t1
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "res" ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:map_t1_e
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_t1 ;
  v-wf:mappingExpression  "task_result.getValue ('res')" ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Вытащить из задачи результаты работы"@ru ;
.

# ------------------------------- NET Complex Route : User Form ---------------------------- #
s-wf:ComplexRouteStartForm
  rdf:type rdfs:Class ;
  rdfs:subClassOf v-wf:StartForm ;
  rdfs:label "Стартовая форма сети Комплексный маршрут"@ru ;
  rdfs:label "Complex route start form"@en ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm
  rdf:type rdfs:Class ;
  rdfs:subClassOf v-wf:StartForm ;
  rdfs:label "Стартовая форма сети Простой маршрут"@ru ;
  rdfs:label "Simple route start form"@en ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_participant
  rdf:type rdf:Property ;
  rdfs:label "Кому"@ru ;
  rdfs:label "To"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Appointment ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_possible_decisions
  rdf:type rdf:Property ;
  rdfs:label "Варианты ответа"@ru ;
  rdfs:label "Possible decisions"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Appointment ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_task_label
  rdf:type rdf:Property ;
  rdfs:label "Название задачи"@ru ;
  rdfs:label "Task label"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:string ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_comment
  rdf:type rdf:Property ;
  rdfs:label "Комментарий"@ru ;
  rdfs:label "Comment"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:string ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_visible
  rdf:type rdf:Property ;
  rdfs:label "Видимый"@ru ;
  rdfs:label "Visible"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_editable
  rdf:type rdf:Property ;
  rdfs:label "Редактируемый"@ru ;
  rdfs:label "Editable"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_controlled
  rdf:type rdf:Property ;
  rdfs:label "Контролируемый"@ru ;
  rdfs:label "Controlled"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_controller
  rdf:type rdf:Property ;
  rdfs:label "Контролирующий"@ru ;
  rdfs:label "Controller"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Appointment ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_deadlineDate
  rdf:type rdf:Property ;
  rdfs:label "Контрольный срок"@ru ;
  rdfs:label "Deadline"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:dateTime ;
  rdfs:isDefinedBy s-wf: ;
.

#s-wf:SimpleRouteStartForm_deadlineInDays
#  rdf:type rdf:Property ;
#  rdfs:label "В днях"@ru ;
#  rdfs:label "In days"@en ;
#  rdfs:domain s-wf:SimpleRouteStartForm ;
#  rdfs:range xsd:boolean ;
#  rdfs:isDefinedBy s-wf: ;
#.

s-wf:SimpleRouteStartForm_deadlineDays
  rdf:type rdf:Property ;
  rdfs:label "Контрольный срок (дней)"@ru ;
  rdfs:label "Deadline (days)"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:integer ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_informing
  rdf:type rdf:Property ;
  rdfs:label "Информирование"@ru ;
  rdfs:label "Informing"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination1
  rdf:type rdf:Property ;
  rdfs:label "Согласование 1 уровня"@ru ;
  rdfs:label "Coordination 1 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination2
  rdf:type rdf:Property ;
  rdfs:label "Согласование 2 уровня"@ru ;
  rdfs:label "Coordination 2 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination3
  rdf:type rdf:Property ;
  rdfs:label "Согласование 3 уровня"@ru ;
  rdfs:label "Coordination 3 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination4
  rdf:type rdf:Property ;
  rdfs:label "Согласование 4 уровня"@ru ;
  rdfs:label "Coordination 4 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination5
  rdf:type rdf:Property ;
  rdfs:label "Согласование 5 уровня"@ru ;
  rdfs:label "Coordination 5 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_coordination6
  rdf:type rdf:Property ;
  rdfs:label "Согласование 6 уровня"@ru ;
  rdfs:label "Coordination 6 level"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_sign
  rdf:type rdf:Property ;
  rdfs:label "Подписание"@ru ;
  rdfs:label "Sign"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_approval
  rdf:type rdf:Property ;
  rdfs:label "Утверждение"@ru ;
  rdfs:label "Approval"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_examination
  rdf:type rdf:Property ;
  rdfs:label "Ознакомление"@ru ;
  rdfs:label "Examination"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_review
  rdf:type rdf:Property ;
  rdfs:label "Рассмотрение"@ru ;
  rdfs:label "Review"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_instruction
  rdf:type rdf:Property ;
  rdfs:label "Поручение"@ru ;
  rdfs:label "Instruction"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_instruction2
  rdf:type rdf:Property ;
  rdfs:label "Поручение"@ru ;
  rdfs:label "Instruction"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteStartForm_instruction3
  rdf:type rdf:Property ;
  rdfs:label "Поручение"@ru ;
  rdfs:label "Instruction"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:ComplexRouteStartForm_distribution
  rdf:type rdf:Property ;
  rdfs:label "Рассылка уведомлений"@ru ;
  rdfs:label "Distribution"@en ;
  rdfs:domain s-wf:ComplexRouteStartForm ;
  rdfs:range s-wf:SimpleRouteStartForm ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:pm_sf
  rdf:type v-s:PermissionStatement ;
  v-s:canCreate "true"^^xsd:boolean ;
  v-s:permissionObject s-wf:SimpleRouteStartForm, s-wf:ComplexRouteStartForm;
  v-s:permissionSubject cfg:AllUsersGroup ;
.

s-wf:SimpleRouteStartFormMinimal_Template
  rdfs:isDefinedBy s-wf: ;
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
  <div>
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="row">
          <div class="col-md-12">
      <strong about="s-wf:SimpleRouteStartForm_participant" property="rdfs:label"></strong>
      <div rel="s-wf:SimpleRouteStartForm_participant" class="view edit -search" data-template="v-ui:LabelTemplate"></div>
          <veda-control data-type="link" rel="s-wf:SimpleRouteStartForm_participant" class="-view edit search dropdown fulltext"></veda-control>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-md-12">
      <strong about="s-wf:SimpleRouteStartForm_comment" property="rdfs:label"></strong>
      <div property="s-wf:SimpleRouteStartForm_comment" class="view -edit -search"></div>
          <veda-control data-type="string" property="s-wf:SimpleRouteStartForm_comment" class="-view edit -search"></veda-control>
          </div>
        </div>
        <br />
      </div>
    </div>
  </div>
  """ ;
.

s-wf:SimpleRouteStartFormShort_Template
  rdfs:isDefinedBy s-wf: ;
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
  <div>
    <div class="panel panel-default">
      <div class="panel-body">
    <div about="@" class="view edit -search" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
      <div class="row">
        <div class="col-md-6">
      <strong about="s-wf:SimpleRouteStartForm_deadlineDays" property="rdfs:label"></strong>
      <div about="@" property="s-wf:SimpleRouteStartForm_deadlineDays" class="view -edit -search"></div>
        <veda-control data-type="integer" property="s-wf:SimpleRouteStartForm_deadlineDays" class="-view edit -search"></veda-control>
        </div>
        <div class="col-md-6">
        </div>
      </div>
      </div>
    </div>
    <br />
  </div>
  """ ;
.

s-wf:SimpleRouteStartFormFull_Template
  rdfs:isDefinedBy s-wf: ;
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
<div class="subroot">
  <div class="panel panel-default">
    <div class="panel-body">
      <div about="@" class="view edit -search" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
      <div class="row">
        <div class="col-md-6">
          <strong about="s-wf:SimpleRouteStartForm_deadlineDays" property="rdfs:label"></strong>
          <div about="@" property="s-wf:SimpleRouteStartForm_deadlineDays" class="view -edit -search"></div>
          <veda-control data-type="integer" property="s-wf:SimpleRouteStartForm_deadlineDays" class="-view edit -search"></veda-control>
        </div>
        <div class="col-md-6">
          <strong about="s-wf:SimpleRouteStartForm_deadlineDate" property="rdfs:label"></strong>
          <div about="@" property="s-wf:SimpleRouteStartForm_deadlineDate" class="view -edit -search"></div>
          <veda-control data-type="dateTime" property="s-wf:SimpleRouteStartForm_deadlineDate" class="-view edit -search"></veda-control>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-md-12">
          <strong about="s-wf:SimpleRouteStartForm_controller" property="rdfs:label"></strong>
          <div about="@" property="s-wf:SimpleRouteStartForm_controller" class="view -edit -search"></div>
          <veda-control about="@" data-type="link" rel="s-wf:SimpleRouteStartForm_controller" class="-view edit -search fulltext dropdown"></veda-control>
        </div>
      </div>
    </div>
  </div>
</div>
  """ ;
.

s-wf:controllerSpecification
  rdf:type v-ui:ObjectPropertySpecification ;
  v-ui:forClass s-wf:SimpleRouteStartForm ;
  v-ui:forProperty s-wf:SimpleRouteStartForm_controller ;
  v-ui:maxCardinality 1 ;
  v-ui:queryPrefix "('rdf:type'=='v-s:Appointment')"^^xsd:string ;
.

s-wf:participantSpecification
  rdf:type v-ui:ObjectPropertySpecification ;
  v-ui:forClass s-wf:SimpleRouteStartForm ;
  v-ui:forProperty s-wf:SimpleRouteStartForm_participant ;
  v-ui:minCardinality 1 ;
  v-ui:maxCardinality 100 ;
  v-ui:queryPrefix "('rdf:type'=='v-s:Appointment')"^^xsd:string ;
.

s-wf:ComplexRouteStartForm_Template
  rdfs:isDefinedBy s-wf: ;
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "Шаблон стартовых данных Комплексного маршрута"@ru ;
  rdfs:label "Complex route start form template"@en ;
  v-ui:forClass s-wf:ComplexRouteStartForm ;
  v-ui:template """
<script>
var stages = [ // Default values fill
  'informing',
  'coordination1',
  'coordination2',
  'coordination3',
  'coordination4',
  'coordination5',
  'coordination6',
  'sign',
  'approval',
  'review',
  'instruction',
  'instruction2',
  'instruction3',
  'examination',
  'distribution',
  'auto_instruction'
];
var complex = 's-wf:ComplexRouteStartForm_';
var simple = 's-wf:SimpleRouteStartForm_';

var routes = [];

var doc = individual['v-wf:processedDocument'][0];

if (doc) {
  stages.forEach(function(stage) {
    routes[stage] = new veda.IndividualModel();
    routes[stage]['rdf:type'] = [new veda.IndividualModel('s-wf:SimpleRouteStartForm')];
  });

  // DEFAULT
  for (var i = 1; i <= 6; i++) {
    routes['coordination'+i][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionAgreed'), newUri('v-wf:DecisionDeclined'), newUri('v-wf:DecisionNotPerformed'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
    routes['coordination'+i][simple+'task_label'] = veda.Util.mlstring("Согласовать", "Coordinate");
  }

  routes['sign'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionSign'), newUri('v-wf:DecisionDeclined'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['sign'][simple+'task_label'] = veda.Util.mlstring("Подписать", "Sign");
  routes['approval'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionApprove'), newUri('v-wf:DecisionDeclined'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['approval'][simple+'task_label'] = veda.Util.mlstring("Подтвердить", "Approve");
  routes['review'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionReview'), newUri('v-wf:DecisionRejected'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['review'][simple+'task_label'] = veda.Util.mlstring("Рассмотреть", "Review");
  routes['instruction'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionAchieved'), newUri('v-wf:DecisionRejected'), newUri('v-wf:DecisionNotPerformed'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['instruction'][simple+'task_label'] = veda.Util.mlstring("Исполнить поручение", "Execute task");
  routes['instruction2'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionAchieved'), newUri('v-wf:DecisionRejected'), newUri('v-wf:DecisionNotPerformed'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['instruction2'][simple+'task_label'] = veda.Util.mlstring("Рассмотреть", "Execute task");
  routes['instruction3'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionAchieved'), newUri('v-wf:DecisionRejected'), newUri('v-wf:DecisionNotPerformed'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['instruction3'][simple+'task_label'] = veda.Util.mlstring("Ознакомиться", "Execute task");
  routes['examination'][simple+'possible_decisions'] = [new String("[newUri ('v-wf:DecisionExamined'), newUri('v-wf:DecisionRejected'), newUri('v-wf:DecisionNotPerformed'), newUri('v-wf:DecisionRedirect'), newUri('v-wf:DecisionNotForMe')]")];
  routes['examination'][simple+'task_label'] = veda.Util.mlstring("Ознакомиться", "Examine");

  // CUSTOM
//-------------------------------------------------------------------------------------------------------------------------------------Акт расследования аварии
  if (doc['rdf:type'][0].id === "mnd-s:ActFailure") {
    if (!doc.hasValue('v-s:hasAction')) {
      // если [action] пусто, то согласование 1 открыто пусто, поручение - [manager] "Провести необходимое расследование"
      routes['coordination1'][simple+'visible'] = [true];
      routes['coordination1'][simple+'editable'] = [true];
      routes['coordination1'][simple+'deadlineDays'] = [10];

      routes['instruction'][simple+'participant'] = doc["mnd-s:actFailureManager"];
      routes['instruction'][simple+'visible'] = [true];
      routes['instruction'][simple+'editable'] = [true];
      routes['instruction'][simple+'deadlineDays'] = [10];
      routes['instruction'][simple+'comment'] = [new String('Провести необходимое расследование')];
    } else {
      // если [action] не пусто, то согласование 1 - [member] + [chief], подписание - пусто, утверждение - Технический директор + Директор по производству
      routes['coordination1'][simple+'visible'] = [true];
      routes['coordination1'][simple+'editable'] = [true];
      if (doc.hasValue('v-s:hasMemberOfWorkGroup')) {
        routes['coordination1'][simple+'participant'] = [];
        doc['v-s:hasMemberOfWorkGroup'].forEach(function(mwg) {
          routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(mwg['v-s:member']);
        });
      }
      routes['sign'][simple+'visible'] = [true];
      routes['sign'][simple+'editable'] = [true];
      routes['sign'][simple+'deadlineDays'] = [10];

      routes['approval'][simple+'participant'] = [new veda.IndividualModel('d:mondi_position_71017804'), new veda.IndividualModel('d:mondi_position_71018870')];
      routes['approval'][simple+'visible'] = [true];
      routes['approval'][simple+'editable'] = [true];
      routes['approval'][simple+'deadlineDays'] = [10];
    }
  }
//---------------------------------------------------------------------------------------------------------------------------Запрос на согласование контрагента
  if (doc['rdf:type'][0].id === "mnd-s:ContractorCategoryRequest") {

    if (doc.hasValue('mnd-s:hasContractorInteractionCategory') && doc['mnd-s:hasContractorInteractionCategory'][0].id == 'd:a188a7057-11d1-ce95-4e3c-3c4712b754f0') {
      // Блокировка
      if (doc.hasValue('mnd-s:contractorRiskDecisionToAccept') && doc['mnd-s:contractorRiskDecisionToAccept'][0] == false) {
        // НЕ оценка рисков
        routes['coordination1'][simple+'participant'] = [new veda.IndividualModel("d:mondi_position_70006692")]; // глав бух
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [true];
        routes['coordination1'][simple+'deadlineDays'] = [5];
        routes['coordination1'][simple+'comment'] = [new String('Сальдо расчетов, наличие просроченной задолженности')];

        if (doc.hasValue('v-s:backwardTarget') && doc['v-s:backwardTarget'][0].hasValue('v-s:backwardTarget')) {
          var squery = "( 'rdf:type' == 'mnd-s:Contract' || 'rdf:type' == 'mnd-s:AdditionalAgreement' ) && 'v-s:supplier' == '"+doc['v-s:backwardTarget'][0]['v-s:backwardTarget'][0].id+"'";
          console.log(squery);
          var s = new veda.SearchModel(squery, null);
          Object.getOwnPropertyNames(s.results).forEach( function (res_id) {
            var obj = new veda.IndividualModel(res_id);
            if (obj.hasValue('mnd-s:supportSpecialistOfContract')) {
              routes['coordination2'][simple+'participant'] = routes['coordination2'][simple+'participant'].concat([new veda.IndividualModel(obj['mnd-s:supportSpecialistOfContract'][0].id)]);
            }
          });
        }
        routes['coordination2'][simple+'visible'] = [true];
        routes['coordination2'][simple+'editable'] = [true];
        routes['coordination2'][simple+'deadlineDays'] = [5];
        routes['coordination2'][simple+'comment'] = [new String('Информация о контракте')];

        routes['coordination3'][simple+'participant'] = [new veda.IndividualModel("d:aaf889b74-6caa-8b21-5404-c6a9f91f8666")]; // ПУ
        routes['coordination3'][simple+'visible'] = [true];
        routes['coordination3'][simple+'editable'] = [true];
        routes['coordination3'][simple+'deadlineDays'] = [5];
        routes['coordination3'][simple+'comment'] = [new String('Заключение о возможности блокировки')];
      } else {
        // Оценка рисков
        routes['instruction'][simple+'participant'] = [
          new veda.IndividualModel("d:mondi_position_71015289"), // Фин директор
          new veda.IndividualModel("d:mondi_position_71020115")]; // Начальник УЗ
        routes['instruction'][simple+'visible'] = [true];
        routes['instruction'][simple+'editable'] = [true];
        routes['instruction'][simple+'deadlineDays'] = [5];

        if (veda.user && veda.user.hasValue('v-s:hasAppointment')) {
          routes['instruction2'][simple+'participant'] = veda.user['v-s:hasAppointment'];
          routes['instruction2'][simple+'visible'] = [true];
          routes['instruction2'][simple+'editable'] = [true];
          routes['instruction2'][simple+'deadlineDays'] = [5];
          routes['instruction2'][simple+'comment'] = [new String('Оценка рисков произведена')];
        }
      }
    } else {
      if (doc.hasValue('mnd-s:contractorRiskDecisionToAccept') && doc['mnd-s:contractorRiskDecisionToAccept'][0] == false) {
        // НЕ оценка рисков
        routes['coordination1'][simple+'participant'] = [new veda.IndividualModel("d:dc50f0d3-0d1b-4505-874a-09c5a9c7333f")];
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [false];
        routes['coordination1'][simple+'deadlineDays'] = [5];

        routes['coordination2'][simple+'participant'] = [new veda.IndividualModel("d:39bd6fed-fad3-453e-bca4-e8ebd0e3cc73")];
        routes['coordination2'][simple+'visible'] = [true];
        routes['coordination2'][simple+'editable'] = [false];
        routes['coordination2'][simple+'deadlineDays'] = [5];

        routes['coordination3'][simple+'visible'] = [true];
        routes['coordination3'][simple+'editable'] = [true];
        routes['coordination3'][simple+'deadlineDays'] = [10];

        if (veda.user && veda.user.hasValue('v-s:hasAppointment')) {
          routes['examination'][simple+'participant'] = veda.user['v-s:hasAppointment'];
          routes['examination'][simple+'visible'] = [true];
          routes['examination'][simple+'editable'] = [false];
          routes['examination'][simple+'deadlineDays'] = [10];
          routes['examination'][simple+'comment'] = [new String('Согласование завершено')];
        }
      } else {
        // Оценка рисков
        routes['coordination1'][simple+'participant'] = [new veda.IndividualModel("d:aaf889b74-6caa-8b21-5404-c6a9f91f8666")]; // ПУ
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [true];
        routes['coordination1'][simple+'deadlineDays'] = [5];
        routes['coordination1'][simple+'comment'] = [new String('Заключение о возможности блокировки')];

        routes['instruction'][simple+'participant'] = [
          new veda.IndividualModel("d:mondi_position_71015289"), // Фин директор
          new veda.IndividualModel("d:mondi_position_71020115")]; // Начальник УЗ
        routes['instruction'][simple+'visible'] = [true];
        routes['instruction'][simple+'editable'] = [true];
        routes['instruction'][simple+'deadlineDays'] = [5];

        if (veda.user && veda.user.hasValue('v-s:hasAppointment')) {
          routes['instruction2'][simple+'participant'] = veda.user['v-s:hasAppointment'];
          routes['instruction2'][simple+'visible'] = [true];
          routes['instruction2'][simple+'editable'] = [true];
          routes['instruction2'][simple+'deadlineDays'] = [5];
          routes['instruction2'][simple+'comment'] = [new String('Оценка рисков произведена')];
        }
      }
    }
  }
//---------------------------------------------------------------------------------------------------------------------Заявка на создание/изменение контрагента
  if (doc['rdf:type'][0].id === "mnd-s:ContractorCreateChangeRequest") {
    routes['approval'][simple+'participant'] = [new veda.IndividualModel('d:3faff975-440f-4499-98c5-eb5eaf4fb04a')]; // Специалист УЗ по ведению кредиторов
    routes['approval'][simple+'visible'] = [true];
    routes['approval'][simple+'editable'] = [true];
    routes['approval'][simple+'deadlineDays'] = [10];
  }

//--------------------------------------------------------------------------------Претензия-------
  if (doc['rdf:type'][0].id === "mnd-s:Claim") {
    routes['informing'][simple+'visible'] = [true];
    routes['informing'][simple+'editable'] = [true];
    routes['coordination1'][simple+'visible'] = [true];
    routes['coordination1'][simple+'editable'] = [true];
    routes['coordination2'][simple+'visible'] = [true];
    routes['coordination2'][simple+'editable'] = [true];
    routes['coordination3'][simple+'visible'] = [true];
    routes['coordination3'][simple+'editable'] = [true];
    routes['sign'][simple+'visible'] = [true];
    routes['sign'][simple+'editable'] = [true];
    routes['sign'][simple+'deadlineDays'] = [5];
    routes['approval'][simple+'visible'] = [true];
    routes['approval'][simple+'editable'] = [true];
    routes['approval'][simple+'deadlineDays'] = [5];
    routes['review'][simple+'visible'] = [true];
    routes['review'][simple+'editable'] = [true];
    routes['review'][simple+'deadlineDays'] = [3];
  }
//-------------------------------------------------------------------------------------------------------------------------------------------Заявка на контракт
  function objectOrParent(doc, objectId) {
    return doc.hasValue('v-s:hasContractObject') &&
      (doc['v-s:hasContractObject'][0].id == objectId
        || (doc['v-s:hasContractObject'][0].hasValue('v-s:hasParentLink') && doc['v-s:hasContractObject'][0]['v-s:hasParentLink'][0].id == objectId));
  }

  function algorithm1(doc) {
     if ( objectOrParent(doc, 'd:379cc929f78f4a4e84f36a9f3830d846')
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00064586_71020091")]; // Байлендер
     }
     if ( objectOrParent(doc, 'd:5af63e5bbeb54c4a86c2bc72fb4208a5') // (целлюлоза)
       || objectOrParent(doc, 'd:3e77773be122494085d07da25fe20076') // (Бумага на втор)
       || objectOrParent(doc, 'd:d8cf8f89a0694bf9b462deb1bc6d09ab') // (технологич химикаты)
       || objectOrParent(doc, 'd:f1bba7b333d14ea582942f7d1e1c97c5') // (Вспомогательные вещества)
       || objectOrParent(doc, 'd:61c11dd2137e4916a94eab49ac88565b') // (Крахмал)
       || objectOrParent(doc, 'd:d63df9806ea84691a4587f65cc73a65b') // (Наполнитель)
       || objectOrParent(doc, 'd:1b89d9d556804828818399207ddf1114') // (Пигменты покровные)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069193_71025072")]; // Фаина Николаева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:43e7ae6b17d34fcd9e58613be049df91') // (Вода)
       || objectOrParent(doc, 'd:e0de239b29c34ec3afaf25b0554893cb') // (Энергия)
       || objectOrParent(doc, 'd:dd56fab4a4f444cd925ee1c99c2fb8ac') // (Топливо)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00009317_71025075")]; // Ирина Константинова : Менеджер по закупке
     }
     if ( objectOrParent(doc, 'd:a6f80eb26bbb4ffcb56691ac5ba511da') //
       || objectOrParent(doc, 'd:b98840ca4b8f47c2b32a12cc01906208') // (краски)
       || objectOrParent(doc, 'd:89e8c38865c54b4eaffc5df506fca683') // (краски 2)
       || objectOrParent(doc, 'd:ed715abf1d80407588efa47ba3c75179') // (краски 3)
       || objectOrParent(doc, 'd:be0101cddba94f7aaa060aaa058e8a4e') // (материалы для печати)
       || objectOrParent(doc, 'd:dbf8b6d152f04d20bd1dcae8e163db51') // (Печатные химикаты )
       || objectOrParent(doc, 'd:51abdbbe8ac94556b4e0455e2374a816') // (полипропилен)
       || objectOrParent(doc, 'd:a8f18e17ce7647788e8b27e712c5ee39') // (силиконы)
       || objectOrParent(doc, 'd:7230749746e943fdb610626e763742fb') // (Standard PE)
       || objectOrParent(doc, 'd:0ff1b5be8bd849f08ca2bf4ed53b7a16') // (клеи)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069224_71024982")]; // Татьяна Румянцева : Руководитель гр.
     }
     if ( objectOrParent(doc, 'd:c7613d1b104d4ffa86a14ee795cdd792') // (Материалы горюче-смазочные)
       || objectOrParent(doc, 'd:987c0881a6464112b1a25c25b4b3b67e') // (Электрика, электроника)
       || objectOrParent(doc, 'd:e04858bc7da54cc9a6b7d44f8ce76731') // (Механика)
       || objectOrParent(doc, 'd:ca2c0746e181466da8999722c98d4c0f') // (Материалы строительные)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069396_71022854")]; // Константин Филяев : Руководитель группы
     }
     if ( objectOrParent(doc, 'd:916b0a3222d144128b3bfc05a690ccd0') // (Расходные материалы)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00061450_71018045")]; // Сергей Валуев : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:6aa0a08ef0fc4aeca55e3f283dc2a9fd') // (Технические услуги)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00061636_71022863")]; // Татьяна Банина : Руководитель группы
     }
     if ( objectOrParent(doc, 'd:b3e9e60c3ecb4ca98ab31179d162815f') // (Косвенные расходы)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00066898_71024981")]; // Роман Мамаев : Руководитель группы
     }
     if ( objectOrParent(doc, 'd:0c350969f2b8449c93594ee767cb27ef') // (Транспорт)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00018845_71018024")]; // Ольга Пономарева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:0c2031235b5248819f19dbd1cdebb307') // (CAPEX)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00068194_71023848")]; // Анна Тарасова : Руководитель группы
     }
     return [];
  }

  function algorithm2(doc) {
     if ( objectOrParent(doc, 'd:379cc929f78f4a4e84f36a9f3830d846')
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00064586_71020091")]; // Байлендер
     }
     if ( objectOrParent(doc, 'd:5af63e5bbeb54c4a86c2bc72fb4208a5') // (целлюлоза)
       || objectOrParent(doc, 'd:3e77773be122494085d07da25fe20076') // (Бумага на втор)
       || objectOrParent(doc, 'd:d8cf8f89a0694bf9b462deb1bc6d09ab') // (технологич химикаты)
       || objectOrParent(doc, 'd:f1bba7b333d14ea582942f7d1e1c97c5') // (Вспомогательные вещества)
       || objectOrParent(doc, 'd:61c11dd2137e4916a94eab49ac88565b') // (Крахмал)
       || objectOrParent(doc, 'd:d63df9806ea84691a4587f65cc73a65b') // (Наполнитель)
       || objectOrParent(doc, 'd:1b89d9d556804828818399207ddf1114') // (Пигменты покровные)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069193_71025072")]; // Фаина Николаева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:43e7ae6b17d34fcd9e58613be049df91') // (Вода)
       || objectOrParent(doc, 'd:e0de239b29c34ec3afaf25b0554893cb') // (Энергия)
       || objectOrParent(doc, 'd:dd56fab4a4f444cd925ee1c99c2fb8ac') // (Топливо)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069193_71025072")]; // Фаина Николаева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:a6f80eb26bbb4ffcb56691ac5ba511da') //
       || objectOrParent(doc, 'd:b98840ca4b8f47c2b32a12cc01906208') // (краски)
       || objectOrParent(doc, 'd:89e8c38865c54b4eaffc5df506fca683') // (краски 2)
       || objectOrParent(doc, 'd:ed715abf1d80407588efa47ba3c75179') // (краски 3)
       || objectOrParent(doc, 'd:be0101cddba94f7aaa060aaa058e8a4e') // (материалы для печати)
       || objectOrParent(doc, 'd:dbf8b6d152f04d20bd1dcae8e163db51') // (Печатные химикаты )
       || objectOrParent(doc, 'd:51abdbbe8ac94556b4e0455e2374a816') // (полипропилен)
       || objectOrParent(doc, 'd:a8f18e17ce7647788e8b27e712c5ee39') // (силиконы)
       || objectOrParent(doc, 'd:7230749746e943fdb610626e763742fb') // (Standard PE)
       || objectOrParent(doc, 'd:0ff1b5be8bd849f08ca2bf4ed53b7a16') // (клеи)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00069224_71024982")]; // Татьяна Румянцева : Руководитель гр.
     }
     if ( objectOrParent(doc, 'd:c7613d1b104d4ffa86a14ee795cdd792') // (Материалы горюче-смазочные)
       || objectOrParent(doc, 'd:987c0881a6464112b1a25c25b4b3b67e') // (Электрика, электроника)
       || objectOrParent(doc, 'd:e04858bc7da54cc9a6b7d44f8ce76731') // (Механика)
       || objectOrParent(doc, 'd:ca2c0746e181466da8999722c98d4c0f') // (Материалы строительные)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00018845_71018024")]; // Ольга Пономарева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:916b0a3222d144128b3bfc05a690ccd0') // (Расходные материалы)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00061450_71018045")]; // Сергей Валуев : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:6aa0a08ef0fc4aeca55e3f283dc2a9fd') // (Технические услуги)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00061450_71018045")]; // Сергей Валуев : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:b3e9e60c3ecb4ca98ab31179d162815f') // (Косвенные расходы)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00018845_71018024")]; // Ольга Пономарева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:0c350969f2b8449c93594ee767cb27ef') // (Транспорт)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00018845_71018024")]; // Ольга Пономарева : Начальник отдела
     }
     if ( objectOrParent(doc, 'd:0c2031235b5248819f19dbd1cdebb307') // (CAPEX)
       ) {
       return [new veda.IndividualModel("d:mondi_appointment_00068194_71023848")]; // Анна Тарасова : Руководитель группы
     }
     return [];
  }

  if (doc['rdf:type'][0].id === "mnd-s:ContractRequest") {
   if (doc.hasValue('v-s:customer') && doc['v-s:customer'][0].id == 'd:org_RU1121003135') {
    // Закупка
    if (doc.hasValue('v-s:hasBudgetCategory') && (
      doc['v-s:hasBudgetCategory'][0].id == 'd:add478ffd-4996-ca11-8d8c-51bf810357c7' ||
      doc['v-s:hasBudgetCategory'][0].id == 'd:a486cc102-8ec8-3f09-b326-6fabeec30882' ||
      doc['v-s:hasBudgetCategory'][0].id == 'd:a0bfac3cc-ecf3-7847-59b2-5793ebd73879' ||
      doc['v-s:hasBudgetCategory'][0].id == 'd:a58764c7b-9730-2baa-68a4-da7b9fa36625')) {
      // CAPEX
      if (doc.hasValue('mnd-s:hasStrategyOfChoice') && doc['mnd-s:hasStrategyOfChoice'][0].id == 'd:a7a1e835a-b23b-8465-cecd-a261a31f78fe') {
        // Стратегия: Проведение конкурса (Тендер)

        routes['coordination1'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00068194_71023848")]; // Анна Тарасова : Руководитель группы
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [true];
        routes['coordination1'][simple+'deadlineDays'] = [10];
        routes['coordination1'][simple+'comment'] = [new String('Согласовать список участников тендера')];

        routes['coordination2'][simple+'participant'] = [
          new veda.IndividualModel("d:mondi_appointment_00061450_71018045"), // Сергей Валуев : Начальник отдела
          new veda.IndividualModel("d:mondi_appointment_00061421_71020115"), // Юлия Рембе : Начальник управления
          new veda.IndividualModel("d:mondi_appointment_00068750_71017804"), // Владимир Дружков : Технический директор
          new veda.IndividualModel("d:mondi_appointment_00047788_71024461")]; // Алексей Мокрецов : Начальник отдела
        routes['coordination2'][simple+'visible'] = [true];
        routes['coordination2'][simple+'editable'] = [true];
        routes['coordination2'][simple+'deadlineDays'] = [10];
        routes['coordination2'][simple+'comment'] = [new String('Согласовать список участников тендера')];

        routes['coordination3'][simple+'participant'] = doc['v-s:creator']; // Заявитель
        routes['coordination3'][simple+'visible'] = [true];
        routes['coordination3'][simple+'editable'] = [true];
        routes['coordination3'][simple+'deadlineDays'] = [10];
        routes['coordination3'][simple+'comment'] = [new String('Разослать ТКП')];

        routes['review'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00068194_71023848")]; // Анна Тарасова : Руководитель группы
        routes['review'][simple+'visible'] = [true];
        routes['review'][simple+'editable'] = [true];
        routes['review'][simple+'deadlineDays'] = [10];
        routes['review'][simple+'comment'] = [new String('Рассмотреть заявку на контракт')];
      } else {
        // Стратегия: Безальтернативная основа

        routes['coordination1'][simple+'participant'] = [
          new veda.IndividualModel("d:mondi_appointment_00068750_71017804"), // Владимир Дружков : Технический директор
          new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [true];
        routes['coordination1'][simple+'deadlineDays'] = [10];
        routes['coordination1'][simple+'comment'] = [new String('Согласовать возможность безальтернативной закупки')];
/*
        routes['coordination2'][simple+'visible'] = [true];
        routes['coordination2'][simple+'editable'] = [true];
        routes['coordination2'][simple+'deadlineDays'] = [10];
*/
        routes['review'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00068194_71023848")]; // Анна Тарасова : Руководитель группы
        routes['review'][simple+'visible'] = [true];
        routes['review'][simple+'editable'] = [true];
        routes['review'][simple+'deadlineDays'] = [10];
        routes['review'][simple+'comment'] = [new String('Рассмотреть заявку на контракт')];
      }
    } else if (doc.hasValue('v-s:hasBudgetCategory') && doc['v-s:hasBudgetCategory'][0].id == 'd:a193b366b-aaeb-c1f2-b101-89c95b10a6c8') {
        // OPEX
        if (doc.hasValue('v-s:responsibleDepartment')) {
          var dep = new veda.IndividualModel(doc['v-s:responsibleDepartment'][0].id);
          if (dep.hasValue('v-s:hasChief')) {
            routes['coordination1'][simple+'participant'] = dep["v-s:hasChief"]; // Руководитель отдела ответственного подразделения
            routes['coordination1'][simple+'comment'] = [new String('Согласовать необходимость контракта')];
          }
        }
        routes['coordination1'][simple+'visible'] = [true];
        routes['coordination1'][simple+'editable'] = [true];
        routes['coordination1'][simple+'deadlineDays'] = [10];

        routes['review'][simple+'participant'] = algorithm1(doc); //АЛГО1
        routes['review'][simple+'visible'] = [true];
        routes['review'][simple+'editable'] = [true];
        routes['review'][simple+'deadlineDays'] = [10];
        routes['review'][simple+'comment'] = [new String('Рассмотреть заявку')];

        routes['examination'][simple+'participant'] = algorithm2(doc); //АЛГО2
        routes['examination'][simple+'visible'] = [true];
        routes['examination'][simple+'editable'] = [true];
        routes['examination'][simple+'deadlineDays'] = [10];
        routes['examination'][simple+'comment'] = [new String('Для информации')];
     }
   } else if (doc.hasValue('v-s:supplier') && doc['v-s:supplier'][0].id == 'd:org_RU1121003135') {
      // Продажа
      routes['coordination1'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
      if (doc.hasValue('v-s:responsibleDepartment')) {
        var dep = new veda.IndividualModel(doc['v-s:responsibleDepartment'][0].id);
        if (dep.hasValue('v-s:hasChief')) {
          routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(dep["v-s:hasChief"]); // Руководитель отдела ответственного подразделения +
        }
      }
      routes['coordination1'][simple+'visible'] = [true];
      routes['coordination1'][simple+'editable'] = [true];
      routes['coordination1'][simple+'deadlineDays'] = [10];
      routes['coordination1'][simple+'comment'] = [new String('Согласовать заявку на контракт')];

      if (doc.hasValue('v-s:hasContractObject') &&
          (doc['v-s:hasContractObject'][0].id == 'd:e0de239b29c34ec3afaf25b0554893cb' || // Энергия
            (doc['v-s:hasContractObject'][0].hasValue('v-s:hasParentLink') && doc['v-s:hasContractObject'][0]['v-s:hasParentLink'][0].id == 'd:e0de239b29c34ec3afaf25b0554893cb'))) {
        routes['instruction'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00068274_71018042")]; // Владимир Басанко : Ведущий инженер
      } else if ((doc.hasValue('v-s:hasObligationKind') && doc['v-s:hasObligationKind'][0].id == 'd:1b0d368c502f4e4db36f0e6cf9513b16') // Аренда
                 || (doc.hasValue('v-s:hasContractObject') && doc['v-s:hasContractObject'][0].hasValue('v-s:hasParentLink') &&  doc['v-s:hasContractObject'][0]['v-s:hasParentLink'][0].id == 'd:1b0d368c502f4e4db36f0e6cf9513b16' )) {
        routes['instruction'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00064646_71018047")]; // Евгений Ротанов : Ведущий инженер
      } else {
        routes['instruction'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00000931_71024418")]; // Ольга Трошина : Инженер
      }
      routes['instruction'][simple+'visible'] = [true];
      routes['instruction'][simple+'editable'] = [true];
      routes['instruction'][simple+'deadlineDays'] = [10];
      routes['instruction'][simple+'comment'] = [new String('Рассмотреть заявку')];

      routes['examination'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00057948_71018986")]; // Игорь Наумов : начальник отдела спец. Продаж
      routes['examination'][simple+'visible'] = [true];
      routes['examination'][simple+'editable'] = [true];
      routes['examination'][simple+'deadlineDays'] = [10];
      routes['examination'][simple+'comment'] = [new String('Для информации')];
    }
  }
//--------------------------------------------------------------------------------------------------------------------------------Выполнение заявки на контракт
  if (doc['rdf:type'][0].id === "mnd-s:TenderProcedure") {
    if (doc.hasValue('v-s:backwardTarget') && doc['v-s:backwardTarget'][0].hasValue('v-s:customer') && doc['v-s:backwardTarget'][0]['v-s:customer'][0].if == "d:org_RU1121003135") {
      // Закупка
      if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasBudgetCategory') && doc['v-s:backwardTarget'][0]['v-s:hasBudgetCategory'][0].id == "d:a193b366b-aaeb-c1f2-b101-89c95b10a6c8") {
        // OPEX
        if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:hasStrategyOfChoice') && doc['v-s:backwardTarget'][0]['mnd-s:hasStrategyOfChoice'][0].id == "d:a7a1e835a-b23b-8465-cecd-a261a31f78fe") {
          // Тендер
          routes['coordination1'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
          routes['coordination1'][simple+'visible'] = [true];
          routes['coordination1'][simple+'editable'] = [true];
          routes['coordination1'][simple+'deadlineDays'] = [10];
          routes['coordination1'][simple+'comment'] = [new String('Согласовать список участников тендера')];

          if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:hasStrategyOfChoice')  && doc['v-s:backwardTarget'][0]['mnd-s:hasStrategyOfChoice'][0].hasValue('v-s:sum')
              && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract'][0]['v-s:sum'][0] > 7000000) {
            // TODO: сделать неудаляемым
            routes['coordination2'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
            routes['coordination2'][simple+'visible'] = [true];
            routes['coordination2'][simple+'editable'] = [true];
            routes['coordination2'][simple+'deadlineDays'] = [10];
            routes['coordination2'][simple+'comment'] = [new String('Согласовать список участников тендера у директора по направлению')];
          }

          if (veda.user && veda.user.hasValue('v-s:hasAppointment')) {
            routes['coordination3'][simple+'participant'] = veda.user['v-s:hasAppointment']; // Заявитель
            routes['coordination3'][simple+'visible'] = [true];
            routes['coordination3'][simple+'editable'] = [true];
            routes['coordination3'][simple+'deadlineDays'] = [10];
            routes['coordination3'][simple+'comment'] = [new String('Провести тендер')];
          }

          routes['coordination4'][simple+'participant'] = [];
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:initiator')) {
            var dep = new veda.IndividualModel(doc['v-s:backwardTarget'][0]['v-s:initiator'][0].id);
            if (dep.hasValue('v-s:hasChief')) {
             routes['coordination4'][simple+'participant'] = routes['coordination4'][simple+'participant'].concat(dep["v-s:hasChief"]); // Руководитель отдела ответственного подразделения +
            }
          }
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:45bb1de686d547098a58ca8b58a8dc5d') { // Механика
             routes['coordination4'][simple+'participant'] = routes['coordination4'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00048762_71013780")); // Андрей Скрябин - Главный механик
          }
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:66f31c625dbd4b49afec313119d731f4') { // электрика
             routes['coordination4'][simple+'participant'] = routes['coordination4'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00044583_71012089")); // Андрей Шульгин - Главный электрик
          }
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:ba1a7913d52e4a47967645767b6f2604') { // КИПиА
             routes['coordination4'][simple+'participant'] = routes['coordination4'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00025753_71000234")); // Юрий Исаев:гл. метролог
          }
          routes['coordination4'][simple+'visible'] = [true];
          routes['coordination4'][simple+'editable'] = [true];
          routes['coordination4'][simple+'deadlineDays'] = [10];
          routes['coordination4'][simple+'comment'] = [new String('Согласовать результаты тендера')];

          routes['coordination5'][simple+'participant'] = algorithm2(doc); //АЛГО2
          routes['coordination5'][simple+'visible'] = [true];
          routes['coordination5'][simple+'editable'] = [true];
          routes['coordination5'][simple+'deadlineDays'] = [10];
          routes['coordination5'][simple+'comment'] = [new String('Согласовать результаты тендера')];

          routes['sign'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
          routes['sign'][simple+'visible'] = [true];
          routes['sign'][simple+'editable'] = [true];
          routes['sign'][simple+'deadlineDays'] = [10];
          routes['sign'][simple+'comment'] = [new String('СУтвердить результаты тендера')];

          if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:expectedValueOfContract') && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract'][0].hasValue('v-s:sum')
              && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] > 7000000) {
            // TODO: сделать неудаляемым
            routes['approval'][simple+'visible'] = [true];
            routes['approval'][simple+'editable'] = [true];
            routes['approval'][simple+'deadlineDays'] = [10];
            routes['approval'][simple+'comment'] = [new String('Согласовать список участников тендера у директора по направлению')];
          }

          if (veda.user && veda.user.hasValue('v-s:hasAppointment')) {
            routes['instruction'][simple+'participant'] = veda.user['v-s:hasAppointment'];
            routes['instruction'][simple+'visible'] = [true];
            routes['instruction'][simple+'editable'] = [false];
            routes['instruction'][simple+'deadlineDays'] = [10];
            routes['instruction'][simple+'comment'] = [new String('Согласование завершено')];
          }

          routes['coordination4'][simple+'participant'] = [];
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:initiator')) {
            var dep = new veda.IndividualModel(doc['v-s:backwardTarget'][0]['v-s:initiator'][0].id);
            if (dep.hasValue('v-s:hasChief')) {
              routes['examination'][simple+'participant'] = dep["v-s:hasChief"]; // Руководитель отдела ответственного подразделения +
              routes['examination'][simple+'participant'] = veda.user['v-s:hasAppointment'];
              routes['examination'][simple+'visible'] = [true];
              routes['examination'][simple+'editable'] = [false];
              routes['examination'][simple+'deadlineDays'] = [10];
              routes['examination'][simple+'comment'] = [new String('Ознакомиться с результатами тендера')];
            }
          }
        } else {
          // Не тендер
          routes['coordination1'][simple+'participant'] = [];
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:45bb1de686d547098a58ca8b58a8dc5d') { // Механика
             routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00048762_71013780")); // Андрей Скрябин - Главный механик
          }
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:66f31c625dbd4b49afec313119d731f4') { // электрика
             routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00044583_71012089")); // Андрей Шульгин - Главный электрик
          }
          if (doc['v-s:backwardTarget'][0].hasValue('v-s:hasSector') == 'd:ba1a7913d52e4a47967645767b6f2604') { // КИПиА
             routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(new veda.IndividualModel("d:mondi_appointment_00025753_71000234")); // Юрий Исаев:гл. метролог
          }
          if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:expectedValueOfContract') && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract'][0].hasValue('v-s:sum')
            && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] > 700000) {
            if (doc['v-s:backwardTarget'][0].hasValue('v-s:initiator')) {
              var dep = new veda.IndividualModel(doc['v-s:backwardTarget'][0]['v-s:initiator'][0].id);
              if (dep.hasValue('v-s:hasChief')) {
                routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(dep["v-s:hasChief"]); // Руководитель отдела ответственного подразделения +
              }
            }
          }
          routes['coordination1'][simple+'visible'] = [true];
          routes['coordination1'][simple+'editable'] = [true];
          routes['coordination1'][simple+'deadlineDays'] = [10];
          routes['coordination1'][simple+'comment'] = [new String('Согласовать возможность безальтернативной закупки')];

          if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:expectedValueOfContract') && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract'][0].hasValue('v-s:sum')
            && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] > 700000) {
            if (doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] < 7000000) {
              routes['coordination2'][simple+'participant'] = algorithm2(doc); //АЛГО2
            } else {
              routes['coordination2'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
            }
          }
          routes['coordination2'][simple+'visible'] = [true];
          routes['coordination2'][simple+'editable'] = [true];
          routes['coordination2'][simple+'deadlineDays'] = [10];
          routes['coordination2'][simple+'comment'] = [new String('Согласовать возможность безальтернативной закупки')];

          if (doc['v-s:backwardTarget'][0].hasValue('mnd-s:expectedValueOfContract') && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract'][0].hasValue('v-s:sum')
            && doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] > 700000) {
            if (doc['v-s:backwardTarget'][0]['mnd-s:expectedValueOfContract']['v-s:sum'][0] < 7000000) {
              routes['approval'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00061421_71020115")]; // Юлия Рембе : Начальник управления
            } else {
            routes['approval'][simple+'comment'] = [new String('Утвердить директором по направлению')];
            }
          }
          routes['approval'][simple+'visible'] = [true];
          routes['approval'][simple+'editable'] = [true];
          routes['approval'][simple+'deadlineDays'] = [10];
        }
      }
    }
  }
//-----------------------------------------------------------------------------------------------------------------------------------------------------Контракт
  if (doc['rdf:type'][0].id === "mnd-s:Contract") {
    if (doc.hasValue('v-s:hasDocumentKind') && doc['v-s:hasDocumentKind'][0].id == 'd:fecef6b8058549cfb0203b55bd2425de') {
      // Заказ Спецификация. Разовая закупка
      routes['coordination1'][simple+'visible'] = [true];
      routes['coordination1'][simple+'editable'] = [true];
      routes['coordination1'][simple+'deadlineDays'] = [10];

      routes['sign'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель по контракту
      routes['sign'][simple+'visible'] = [true];
      routes['sign'][simple+'editable'] = [true];
      routes['sign'][simple+'deadlineDays'] = [10];

      routes['approval'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель по контракту
      routes['approval'][simple+'visible'] = [true];
      routes['approval'][simple+'editable'] = [true];
      routes['approval'][simple+'deadlineDays'] = [10];
      routes['approval'][simple+'comment'] = [new String('Подписать у контрагента')];

      routes['review'][simple+'participant'] = [new veda.IndividualModel("d:61e1919e-2460-41ed-8692-042d2634542a")]; // Регистратор документов СЛПК
      routes['review'][simple+'visible'] = [true];
      routes['review'][simple+'editable'] = [false];
      routes['review'][simple+'deadlineDays'] = [10];
      routes['review'][simple+'comment'] = [new String('Оформить подписанный контракт')];
    }
    if (doc.hasValue('v-s:hasDocumentKind') && doc['v-s:hasDocumentKind'][0].id == 'd:cc87e0778a864272b1b8d366f591da88') {
      // Контракт
      if (doc.hasValue('v-s:customer') && doc['v-s:customer'][0].id == 'd:org_RU1121003135') {
        // Контракт о закупке
        if (doc.hasValue('v-s:hasBudgetCategory') && (
          doc['v-s:hasBudgetCategory'][0].id == 'd:add478ffd-4996-ca11-8d8c-51bf810357c7' ||
          doc['v-s:hasBudgetCategory'][0].id == 'd:a486cc102-8ec8-3f09-b326-6fabeec30882' ||
          doc['v-s:hasBudgetCategory'][0].id == 'd:a0bfac3cc-ecf3-7847-59b2-5793ebd73879' ||
          doc['v-s:hasBudgetCategory'][0].id == 'd:a58764c7b-9730-2baa-68a4-da7b9fa36625')) {
          // CAPEX
          routes['informing'][simple+'participant'] = [new veda.IndividualModel("d:ff670646-d509-4ff9-92f2-482c255441e8")]; // Специалист ОУП

          routes['coordination1'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
          if (doc.hasValue('v-s:responsibleDepartment')) {
            var dep = new veda.IndividualModel(doc['v-s:responsibleDepartment'][0].id);
            if (dep.hasValue('v-s:hasChief')) {
            routes['coordination1'][simple+'participant'] = routes['coordination1'][simple+'participant'].concat(dep["v-s:hasChief"]); // Руководитель отдела ответственного подразделения +
            }
          }
          routes['coordination1'][simple+'visible'] = [true];
          routes['coordination1'][simple+'editable'] = [false];
          routes['coordination1'][simple+'deadlineDays'] = [10];

          // TODO добавить людей
          routes['coordination2'][simple+'visible'] = [true];
          routes['coordination2'][simple+'editable'] = [true];
          routes['coordination2'][simple+'deadlineDays'] = [10];

          routes['coordination3'][simple+'participant'] = [
            new veda.IndividualModel("d:3bcad243-5d01-4eba-b62b-1fe233ea2cfa"), // Главный бухгалтер
            new veda.IndividualModel("d:351a59f7-0f25-4f66-8f24-201d1ff95237")]; // Юрисконсульт
          routes['coordination3'][simple+'visible'] = [true];
          routes['coordination3'][simple+'deadlineDays'] = [10];
          if (!doc.hasValue('mnd-s:hasCriterionOfSimplifiedCoordination')) {
            // Упрощенное согласование
            routes['coordination3'][simple+'editable'] = [true];
          } else {
            routes['coordination3'][simple+'editable'] = [false];
          }

          routes['coordination4'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
          routes['coordination4'][simple+'visible'] = [true];
          routes['coordination4'][simple+'editable'] = [true];
          routes['coordination4'][simple+'deadlineDays'] = [2];
          routes['coordination4'][simple+'comment'] = [new String('Согласовать с Контрагентом текcт Контракта и подготовить документы к подписанию')];

          routes['sign'][simple+'visible'] = [true];
          routes['sign'][simple+'editable'] = [true];
          routes['sign'][simple+'deadlineDays'] = [10];

          routes['approval'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
          routes['approval'][simple+'visible'] = [true];
          routes['approval'][simple+'editable'] = [false];
          routes['approval'][simple+'deadlineDays'] = [10];
          routes['approval'][simple+'comment'] = [new String('Поставить отметку о подписании контрагентом')];

          routes['review'][simple+'participant'] = [new veda.IndividualModel("d:61e1919e-2460-41ed-8692-042d2634542a")]; // Регистратор документов СЛПК
          routes['review'][simple+'visible'] = [true];
          routes['review'][simple+'editable'] = [false];
          routes['review'][simple+'deadlineDays'] = [10];
          routes['review'][simple+'comment'] = [new String('Оформить подписанный контракт')];

          if (doc['v-s:supplier'] && doc['v-s:supplier'][0].hasValue('v-s:hasContractorProfile') && doc['v-s:supplier'][0]['v-s:hasContractorProfile'][0].hasValue('mnd-s:hasContractorCategoryRequest')
            && doc['v-s:supplier'][0]['v-s:hasContractorProfile'][0]['mnd-s:hasContractorCategoryRequest'].length == 1
            && doc['v-s:supplier'][0]['v-s:hasContractorProfile'][0]['mnd-s:hasContractorCategoryRequest'][0].hasValue('mnd-s:hasContractorInteractionCategory')
            && doc['v-s:supplier'][0]['v-s:hasContractorProfile'][0]['mnd-s:hasContractorCategoryRequest'][0]['mnd-s:hasContractorInteractionCategory'][0].id == 'd:3dcd8dd19b8f4ab193ea2d8f469771cb') {
              routes['examination'][simple+'participant'] = [new veda.IndividualModel("d:3faff975-440f-4499-98c5-eb5eaf4fb04a")]; // Специалист по ведению кредиторов
              routes['examination'][simple+'visible'] = [true];
              routes['examination'][simple+'editable'] = [false];
              routes['examination'][simple+'deadlineDays'] = [10];
          }
        }
      }
      if (doc.hasValue('v-s:supplier') && doc['v-s:supplier'][0].id == 'd:org_RU1121003135') {
        // Контракт о продаже
          routes['coordination1'][simple+'visible'] = [true];
          routes['coordination1'][simple+'editable'] = [true];
          routes['coordination1'][simple+'deadlineDays'] = [10];

          routes['coordination2'][simple+'visible'] = [true];
          routes['coordination2'][simple+'editable'] = [true];
          routes['coordination2'][simple+'deadlineDays'] = [10];

          routes['coordination3'][simple+'visible'] = [true];
          routes['coordination3'][simple+'editable'] = [true];
          routes['coordination3'][simple+'deadlineDays'] = [10];

          routes['coordination4'][simple+'participant'] = [
            new veda.IndividualModel("d:3bcad243-5d01-4eba-b62b-1fe233ea2cfa"), // Главный бухгалтер
            new veda.IndividualModel("d:351a59f7-0f25-4f66-8f24-201d1ff95237")]; // Юрисконсульт
          routes['coordination4'][simple+'visible'] = [true];
          routes['coordination4'][simple+'editable'] = [true];
          routes['coordination4'][simple+'deadlineDays'] = [10];

          routes['approval'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
          routes['approval'][simple+'visible'] = [true];
          routes['approval'][simple+'editable'] = [false];
          routes['approval'][simple+'deadlineDays'] = [10];
          routes['approval'][simple+'comment'] = [new String('Поставить отметку о подписании контрагентом')];

          routes['review'][simple+'participant'] = doc['mnd-s:executorSpecialistOfContract']; // Исполнитель
          routes['review'][simple+'visible'] = [true];
          routes['review'][simple+'editable'] = [false];
          routes['review'][simple+'deadlineDays'] = [10];
          routes['review'][simple+'comment'] = [new String('Оформить подписанный контракт')];

      }
    }
  }
//----------------------------------------------------------------------------------------------------------------------------------Заявка на cброс сточных вод
  if (doc['rdf:type'][0].id === "mnd-s:RequestWasteWaterDischarge") {
    // #COORDINATION1---------------------------------------------------------------------------------------------------------------------------------------
    routes['coordination1'][simple+'participant'] = [
      new veda.IndividualModel("d:mondi_appointment_00046884_71015702"), // Дмитрий Злобин : Начальник управления
      new veda.IndividualModel("d:mondi_appointment_00058098_71024364") // Дмитрий Очеретенко : Главный эколог
    ];
    routes['coordination1'][simple+'visible'] = [true];
    routes['coordination1'][simple+'editable'] = [false];
    routes['coordination1'][simple+'deadlineDays'] = [10];
    // #EXAMINATION-----------------------------------------------------------------------------------------------------------------------------------------
    routes['examination'][simple+'participant'] = [
      new veda.IndividualModel("d:mondi_appointment_00049652_71000049"), // Вячеслав Луппов : Начальник
      new veda.IndividualModel("d:mondi_appointment_00027183_71015712"), // Александр Разумов : Начальник цеха
      new veda.IndividualModel("d:mondi_appointment_00066961_71024365"), // Дмитрий Караваев : Заместитель главного эколога
      new veda.IndividualModel("d:mondi_appointment_00016254_71019236"), // Сергей Щербаков : Заместитель начальника участка
      new veda.IndividualModel("d:mondi_appointment_00008542_71020127"), // Елена Ивашова : Инженер-технолог 1 категории
      new veda.IndividualModel("d:mondi_appointment_00056698_71019099"), // Елена Астраханова : Ведущий инженер
      new veda.IndividualModel("d:mondi_appointment_00057709_71011432"), // Наталья Пронько : Ведущий инженер
      new veda.IndividualModel("d:SYK-SMEN-WATR_appointment"), // Сотрудник. Мастер УВКХ
      new veda.IndividualModel("d:SYK-MASTERS-OPDH_appointment"), // Мастерам УПХ ВОЦ (SYK-Masters-OPDH)
      new veda.IndividualModel("d:GLAV_DISP_appointment")
    ];
    routes['examination'][simple+'visible'] = [true];
    routes['examination'][simple+'editable'] = [false];
    routes['examination'][simple+'deadlineDays'] = [10];
    // #INSTRUCTION-----------------------------------------------------------------------------------------------------------------------------------------
    routes['instruction'][simple+'participant'] = doc['v-s:creator'].concat([new veda.IndividualModel("d:SYK-SMEN-WATR_appointment")]); // Сотрудник. Мастер УВКХ
    routes['instruction'][simple+'visible'] = [true];
    routes['instruction'][simple+'editable'] = [false];
    routes['instruction'][simple+'deadlineDays'] = [10];
    routes['instruction'][simple+'comment'] = [new String('Заполнить отчёт')];

    // #INSTRUCTION2----------------------------------------------------------------------------------------------------------------------------------------
    routes['instruction2'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00056698_71019099")]; // Елена Астраханова : Ведущий инженер
    routes['instruction2'][simple+'visible'] = [true];
    routes['instruction2'][simple+'editable'] = [false];
    routes['instruction2'][simple+'deadlineDays'] = [10];
    routes['instruction2'][simple+'comment'] = [new String('Проверить результаты')];

    // #INSTRUCTION3----------------------------------------------------------------------------------------------------------------------------------------
    routes['instruction3'][simple+'participant'] = [new veda.IndividualModel("d:mondi_appointment_00058098_71024364")]; // Дмитрий Очеретенко : Главный эколог
    routes['instruction3'][simple+'visible'] = [true];
    routes['instruction3'][simple+'editable'] = [false];
    routes['instruction3'][simple+'deadlineDays'] = [10];
    routes['instruction3'][simple+'comment'] = [new String('Ознакомиться с результатами')];
  }

  if (doc['rdf:type'][0].id === "s-wf:ComplexRouteTest") {
      routes['coordination1'][simple+'participant'] = [
                   new veda.IndividualModel("td:RomanKarpov-Analyst1"),
                   new veda.IndividualModel("td:AndreyBychin-Analyst2")];
      routes['coordination1'][simple+'visible'] = [true];

      routes['coordination2'][simple+'participant'] = [
                   new veda.IndividualModel("td:RomanKarpov-Analyst1"),
                   new veda.IndividualModel("td:AndreyBychin-Analyst2")];
      routes['coordination2'][simple+'visible'] = [true];;

      routes['review'][simple+'participant'] = [new veda.IndividualModel("td:AndreyBychin-Analyst2")];
      routes['review'][simple+'visible'] = [true];
      routes['instruction'][simple+'participant'] = [new veda.IndividualModel("td:AndreyBychin-Analyst2")];
      routes['instruction'][simple+'visible'] = [true];
      routes['examination'][simple+'participant'] = [new veda.IndividualModel("td:AndreyBychin-Analyst2")];
      routes['examination'][simple+'visible'] = [true];
      routes['instruction2'][simple+'participant'] = [new veda.IndividualModel("td:RomanKarpov-Analyst1")];
      routes['instruction2'][simple+'visible'] = [true];
      routes['instruction2'][simple+'controller'] = [new veda.IndividualModel("td:RomanKarpov-Analyst1")];
  }
  if (doc['rdf:type'][0].id === "s-wf:ComplexRouteTest2") {
      routes['coordination1'][simple+'participant'] = [
                   new veda.IndividualModel("td:AndreyBychin-Analyst2")]
      routes['coordination1'][simple+'visible'] = [true];
  }

  stages.forEach(function(stage) {
    var routeid = complex+stage;
    individual[routeid] = [routes[stage]];
    var sub = individual[routeid][0];
    if (!sub.hasValue(simple+'visible') || sub[simple+'visible'][0] == false) {
      $('.'+stage, template).hide();
    }
    if (!sub.hasValue(simple+'editable') || sub[simple+'editable'][0] == false) {
      $('.'+stage+' > div', template).attr('about', '@');
      $('.'+stage+' > div', template).removeAttr('data-embedded');
      $('veda-control[rel="s-wf:ComplexRouteStartForm_'+stage+'"]', template).remove();
      sub.save();
    }
  });
}
$('#save_and_start_process', template).on('click', function () {
  stages.forEach(function(stage) {
    var routeid = complex+stage;
    var sub = individual[routeid][0];
    if (!sub || !sub.hasValue(simple+'participant') || sub.properties[simple+'participant'].length == 0) {
      delete individual.properties[routeid];
    }
  });
  veda.Util.send(individual, template);
});
//# sourceURL=s-wf:ComplexRouteStartForm_Template_pre
</script>
<div class="container-fluid">
  <div class="panel panel-default">
    <div class="panel-heading">
      <div class="row">
        <div class="col-md-6">
        <span about="s-wf:ComplexRouteStartForm" property="rdfs:label" />
        </div>
        <div class="col-md-6 text-right">
          <a href="#/@"><span property="@">ID</span></a>
        </div>
      </div>
    </div>
    <div class="panel-body">
<!--
      <div class="row">
          <div class="col-md-4">
             <em about="v-wf:processInitiator" property="rdfs:label"></em>
             <div rel="v-wf:processInitiator" data-template="td:AppointmentTemplate2">td:AppointmentTemplate2</div>
          </div>
          <div class="col-md-4">
             <em about="v-wf:processedDocument" property="rdfs:label"></em>
             <div rel="v-wf:processedDocument" data-template="v-ui:ClassNameLabelLinkTemplate"></div>
          </div>
          <div class="col-md-4">
             <em about="v-wf:forNet" property="rdfs:label"></em>
             <div rel="v-wf:forNet" data-template="v-ui:ClassNameLabelLinkTemplate"></div>
          </div>
          <div class="col-md-4">
             <em about="v-wf:isProcess" property="rdfs:label"></em>
             <div rel="v-wf:isProcess" data-template="v-ui:ClassNameLabelLinkTemplate"></div>
          </div>
          <div class="col-md-4">
             <em about="v-wf:useTransformation" property="rdfs:label"></em>
             <div rel="v-wf:useTransformation" data-template="v-ui:ClassNameLabelLinkTemplate"></div>
          </div>
      </div>
      <hr />
-->
      <div class="row">
          <div class="col-md-4 informing">
             <em about="s-wf:ComplexRouteStartForm_informing" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_informing" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination1">
             <em about="s-wf:ComplexRouteStartForm_coordination1" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination1" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination2">
             <em about="s-wf:ComplexRouteStartForm_coordination2" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination2" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination3">
             <em about="s-wf:ComplexRouteStartForm_coordination3" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination3" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination4">
             <em about="s-wf:ComplexRouteStartForm_coordination4" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination4" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination5">
             <em about="s-wf:ComplexRouteStartForm_coordination5" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination5" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 coordination6">
             <em about="s-wf:ComplexRouteStartForm_coordination6" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_coordination6" data-template="s-wf:SimpleRouteStartFormShort_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 sign">
             <em about="s-wf:ComplexRouteStartForm_sign" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_sign" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 approval">
             <em about="s-wf:ComplexRouteStartForm_approval" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_approval" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 review">
             <em about="s-wf:ComplexRouteStartForm_review" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_review" data-template="s-wf:SimpleRouteStartFormFull_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 examination">
             <em about="s-wf:ComplexRouteStartForm_examination" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_examination" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 instruction">
             <em about="s-wf:ComplexRouteStartForm_instruction" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_instruction" data-template="s-wf:SimpleRouteStartFormFull_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 instruction2">
             <em about="s-wf:ComplexRouteStartForm_instruction" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_instruction2" data-template="s-wf:SimpleRouteStartFormFull_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 instruction3">
             <em about="s-wf:ComplexRouteStartForm_instruction" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_instruction3" data-template="s-wf:SimpleRouteStartFormFull_Template" data-embedded="true"></div>
          </div>
          <div class="col-md-4 distribution">
             <em about="s-wf:ComplexRouteStartForm_distribution" property="rdfs:label"></em>
             <div rel="s-wf:ComplexRouteStartForm_distribution" data-template="s-wf:SimpleRouteStartFormMinimal_Template" data-embedded="true"></div>
          </div>
      </div>
      <hr />
    </div>
    <div class="panel-footer">
      <button type="button" class="action btn btn-warning" id="save_and_start_process" about="v-s:Send" property="rdfs:label"></button>
      <button type="button" class="action btn btn-default" id="cancel" about="v-s:Cancel" property="rdfs:label"></button>
    </div>
  </div>
</div>
<script>
/*
  var stages = [ // Default values fill
    'informing',
    'coordination1',
    'coordination2',
    'coordination3',
    'coordination4',
    'coordination5',
    'coordination6',
    'sign',
    'approval',
    'review',
    'instruction',
    'instruction2',
    'instruction3',
    'examination',
    'distribution',
    'auto_instruction'
  ]; sourceURL=s-wf:ComplexRouteStartForm_Template
    var complex = 's-wf:ComplexRouteStartForm_';
    var simple = 's-wf:SimpleRouteStartForm_';
    stages.forEach(function(stage) {
      var routeid = complex+stage;
      individual[routeid] = [routes[stage]];
      var sub = individual[routeid][0];
      if (!sub.hasValue(simple+'editable') || sub[simple+'editable'][0] == false) {
        $('veda-control[rel="s-wf:ComplexRouteStartForm_'+stage+'"]').hide();
      }
    });
*/
</script>
  """ ;
.

s-wf:ComplexRouteTest
    rdf:type rdfs:Class ;
    rdfs:label "Тестовый шаблон комплексного маршурута"@ru;
    rdfs:label "Complex route test template"@en;
    rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteTest_Template
    rdfs:isDefinedBy s-wf: ;
    rdf:type v-ui:ClassTemplate ;
    rdfs:label "Шаблон для Тестовый шаблон комплексного маршурута"@ru;
    rdfs:label "Template for Complex route test template"@en;
    v-ui:forClass s-wf:ComplexRouteTest ;
    v-ui:template """
<div class="container-fluid">
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="row">
                <div class="col-md-6">
                    <span about="s-wf:ComplexRouteTest" property="rdfs:label" />
                </div>
                <div class="col-md-6 text-right">
                    <a href="#/@"><span property="@">ID</span></a>
                </div>
            </div>
        </div>
        <div class="btn-group dropup">
            <button class="btn btn-warning dropdown-toggle sendbutton" data-toggle="dropdown">
                <span about="v-s:SendTask" property="rdfs:label"> </span>
                    <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" id="standard-tasks">
            </ul>
        </div>
        <div class="panel-footer">
            <button type="button" class="action btn btn-warning" id="send" about="v-s:Send" property="rdfs:label"></button>
        </div>
    </div>
</div>
<script>
    $('#send.action', template).on('click', function () {
        veda.Util.send(individual, template, 's-wf:complexRouteTransform');
    });
</script>
""" ;
.

s-wf:ComplexRouteTest2
  rdf:type rdfs:Class ;
  rdfs:subClassOf v-s:Journaling ;
  rdfs:label "Тестовый шаблон комплексного маршурута 2"@ru;
  rdfs:label "Complex route test template 2"@en;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:ComplexRouteTest2_Template
  rdfs:isDefinedBy s-wf: ;
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "Шаблон для Тестовый шаблон комплексного маршурута 2"@ru;
  rdfs:label "Template for Complex route test template 2"@en;
  v-ui:forClass s-wf:ComplexRouteTest2 ;
  v-ui:template """
<div class="container-fluid">
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="row">
                <div class="col-md-6">
                    <span about="s-wf:ComplexRouteTest2" property="rdfs:label" />
                </div>
                <div class="col-md-6 text-right">
                    <a href="#/@"><span property="@">ID</span></a>
                </div>
            </div>
        </div>
        <div class="panel-footer">
            <button type="button" class="action btn btn-warning" id="send" about="v-s:Send" property="rdfs:label"></button>
        </div>
    </div>
</div>
<script>
    $('#send.action', template).on('click', function () {
        veda.Util.send(individual, template, 's-wf:complexRouteTransform');
    });
</script>
""" ;
.

#--------------------------------------------------------------------------------------

s-wf:tr_taken_decision
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform3_3 ;
  v-wf:transformRule s-wf:rul_transform3_2 ;
  v-wf:transformRule s-wf:rul_transform3_1 ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:rul_transform3_1
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putFieldOfIndividFromElement ('v-wf:variableValue', 'rdf:type')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform3_2
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putValue ('v-wf:variableValue')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'result_data')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform3_3
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putExecutor ('v-wf:variableValue')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'executor')";
  rdfs:isDefinedBy s-wf: ;
.

#--------------------------------------------------------------------------------------

s-wf:tr_sign_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform22_1 ;
  v-wf:transformRule s-wf:rul_transform22_2 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform22_1
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'initiator')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:from')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.
s-wf:rul_transform22_2
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'подписание документа ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionSign')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionRemake')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

#--------------------------------------------------------------------------------------
s-wf:tr_review_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_5 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_5
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'рассмотрение по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionReview')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_instruct_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_4 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_4
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'поручение по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionAchieved')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionNotPerformed')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_examin_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_3 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_3
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'ознакомление по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionExamined')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_approv_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_2 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_1
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'initiator')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:from')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_2
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'утверждение подписанного документа ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionApprove')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionRemake')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : ------------------------------------- #

s-wf:codelet_create_use_transformation
  rdf:type v-s:Codelet ;
  rdfs:label "Создать на основе трансформации (src_uri, transformation_uri)" ;
  v-s:script """
  create_use_transformation (process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : ------------------------------------- #

s-wf:codelet_add_value_to_document
  rdf:type v-s:Codelet ;
  rdfs:label "Добавить значение в поле документа (src_uri, name_uri, value)" ;
  v-s:script """
  add_value_to_document(process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : ------------------------------------- #

s-wf:codelet_set_value_to_document
  rdf:type v-s:Codelet ;
  rdfs:label "Заменить значение в поле документа (src_uri, name_uri, value)" ;
  v-s:script """
  set_value_to_document(process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : ------------------------------------- #

s-wf:codelet_get_type_of_docId
  rdf:type v-s:Codelet ;
  rdfs:label "Взять тип документа в переменной docId" ;
  v-s:script """
  get_type_of_docId (task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : "запущен ли процесс по документу" ------------------------------------- #
s-wf:codelet_is_run
  rdf:type v-s:Codelet ;
  rdfs:label "Запущен ли процесс по документу" ;
  v-s:script """
  is_in_docflow_and_set_if_true (task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : "понизить права" ----------------------------- #
s-wf:codelet_down_right
  rdf:type v-s:Codelet ;
  rdfs:label "Понизить права" ;
  v-s:script """
  process.getInputVariable ('rightset')?
  change_rights (process, task, process.getInputVariable ('rightset')) :
  down_right_and_store (process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:codelet_change_controller_right
  rdf:type v-s:Codelet ;
  rdfs:label "Выдать права контролирующему" ;
  v-s:script """
  process.getInputVariable ('rightset')?
  change_rights_actor (process, task, process.getInputVariable ('rightset'), 'controller') :
  down_right_and_store (process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:codelet_change_responsible_right
  rdf:type v-s:Codelet ;
  rdfs:label "Выдать права ответственному" ;
  v-s:script """
  process.getInputVariable ('rightset')?
  change_rights_actor (process, task, process.getInputVariable ('rightset'), 'responsible') :
  down_right_and_store (process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.


# ------------------------------ CODELET : "восстановить права" ----------------------------- #
s-wf:codelet_restore_right
  rdf:type v-s:Codelet ;
  rdfs:label "Восстановить права" ;
  v-s:script """
  restore_right (task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : "вывести из документооборота" ----------------------------- #
s-wf:codelet_interrupt_process
  rdf:type v-s:Codelet ;
  rdfs:label "Вывести из документооборота" ;
  v-s:script """
  interrupt_process (process.ticket, process, "")
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------ CODELET : "рассылка" ----------------------------- #
s-wf:codelet_distribution
  rdf:type v-s:Codelet ;
  rdfs:label "Рассылка" ;
  v-s:script """
  distribution (process, task)
""" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------- NET Complex Route : User Form ---------------------------- #
s-wf:UserTaskForm
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:DecisionForm ;
  rdfs:label "Форма ответа на задачу"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
# ------------------------------------------------------------------------------------------

s-wf:UserTaskFormTemplate
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон для класса Форма ответа на задачу"@ru ;
  v-ui:forClass s-wf:UserTaskForm ;
  v-ui:template """
<script>
  var radioTmpl = $(".radio.decision", template);
  if (individual.hasValue("v-wf:possibleDecisionClass")) {
    individual["v-wf:possibleDecisionClass"].map( function (value, index) {
      var tmpl = radioTmpl.clone().insertBefore(radioTmpl);
      var input = $("input", tmpl).val(index);
      $("label", tmpl).append(value["rdfs:label"].join(", "));
      input.change(function () {
        var type = individual["v-wf:possibleDecisionClass"][$(this).val()];
        var decision = createDecision(type);
        individual["v-wf:takenDecision"] = [ decision ];
      });
      if (
        individual.hasValue("v-wf:takenDecision")
        && individual.isSync()
        && individual["v-wf:takenDecision"][0]["rdf:type"][0].id === individual["v-wf:possibleDecisionClass"][index].id
      ) {
        input.prop("checked", true);
      }
    });
  }
  radioTmpl.remove();
  template.on("view edit search", function (e) {
    e.type === "view" ? $(".radio.decision", template).addClass("disabled").find("input").prop("disabled", true) :
    e.type === "edit" ? $(".radio.decision", template).removeClass("disabled").find("input").prop("disabled", false) :
              $(".radio.decision", template).removeClass("disabled").find("input").prop("disabled", false);
  });
  function createDecision(type) {
    var decision = new veda.IndividualModel();
    decision["rdf:type"] = [ type ];
    decision["rdfs:label"] = type["rdfs:label"];
    decision["v-s:parent"] = [ individual ];
    return decision;
  }
  //# sourceURL=s-wf:UserTaskFormTemplate_pre
</script>
<div>
  <div class="container">
    <div class="panel panel-default">
      <div class="panel-heading">
        <span about="s-wf:UserTaskForm" property="rdfs:label"></span>
      </div>
      <div class="panel-body">
        <h3 about="@" property="rdfs:label"></h3>
        <div class="row">
          <div class="col-md-3">
            <em about="v-wf:from" property="rdfs:label"></em>
            <div about="@" rel="v-wf:from" data-template="v-ui:LabelTemplate"></div>
          </div>
          <div class="col-md-3">
             <em about="v-wf:to" property="rdfs:label"></em>
             <div about="@" rel="v-wf:to" data-template="v-ui:LabelTemplate"></div>
          </div>
          <div class="col-md-3">
            <em about="v-s:description" property="rdfs:label"></em>
            <div about="@" property="v-s:description"></div>
          </div>
          <div class="col-md-3">
            <em about="v-wf:dateGiven" property="rdfs:label"></em>
            <div about="@" property="v-wf:dateGiven"></div>
          </div>
        </div>
        <hr />
        <em about="v-wf:takenDecision" property="rdfs:label"></em>
        <div class="radio decision">
          <label>
            <input type="radio" name="decisionRadios">
          </label>
        </div>
        <div about="@" rel="v-wf:takenDecision" data-embedded="true"></div>
      </div>

      <div class="panel-footer">
        <button type="button" class="action btn btn-primary -view edit -search" id="send">Ok</button>
        <button type="button" class="action btn btn-default -view edit -search" id="cancel" about="v-s:Cancel" property="rdfs:label"/>
  <!--  Добавить кнопку Выдать задачу
        <div class="btn-group dropup">
          <button class="btn btn-warning btn-block dropdown-toggle sendbutton" data-toggle="dropdown">
            <span about="v-s:SendTask" property="rdfs:label"> </span>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" id="standard-tasks">
          </ul>
        </div>
  -->
        <!-- button type="button" class="action btn btn-success -view edit -search" id="save" about="v-s:Save" property="rdfs:label"/ -->
        <!-- button type="button" class="action btn btn-warning view -edit -search" id="rightsOrigin" about="v-s:RightsOrigin" property="rdfs:label"/ -->
      </div>
    </div>
  </div>
  <div about="@" rel="v-wf:onDocument" class="view edit -search"></div>
</div>
<script>
  var isMine = (veda.appointment && veda.appointment.id === individual["v-wf:to"][0].id)
            || (veda.appointment && veda.appointment.hasValue("v-s:occupation") && veda.appointment["v-s:occupation"][0].id === individual["v-wf:to"][0].id)
            || (veda.user && veda.user.id === individual["v-wf:to"][0].id);
  var isOpen = !individual.hasValue("v-wf:takenDecision") || !individual.isSync();
  if (isMine && isOpen) {
    $(".radio.decision input", template).first().prop("checked", true).change();
    template.trigger("edit");
  } else {
    template.trigger("view");
  }
  $("#cancel, #send", template).click( function (e) {
    e.stopPropagation();
    //window.history.back();
    riot.route("#/v-ft:Inbox");
  });
  //# sourceURL=s-wf:UserTaskFormTemplate_post
</script>
  """ ;
  .

v-wf:DecisionGoSign
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к этапу подписания"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoApproval
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к этапу утверждения"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination1
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 1 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination2
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 2 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination3
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 3 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination4
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 4 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination5
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 5 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

v-wf:DecisionGoCoordination6
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к 6 этапу согласования"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

#----------------------- Coordination Net ------------------------------
s-wf:tr_actor_add_request_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_tr_form_1 ;
  v-wf:transformRule s-wf:rul_tr_form_1a ;
  v-wf:transformRule s-wf:rul_tr_form_2 ;
  v-wf:transformRule s-wf:rul_tr_form_6a ;
  v-wf:transformRule s-wf:rul_tr_form_9a ;
  v-wf:transformRule s-wf:rul_tr_form_a ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Трансформация создания пользовательской формы дополнительного запроса по задаче"@ru ;
.

s-wf:rul_tr_form_6a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'possible_decision_for_add_reaction')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:possibleDecisionClass')";
  v-wf:grouping "1";
  rdfs:label "Установить возможные варианты ответов"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_tr_form_9a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'actor_task_description')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-s:description')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить v-s:description из переменной s-wf:var_actor_task_action"@ru ;
.


s-wf:tr_actor_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_tr_form_1 ;
  v-wf:transformRule s-wf:rul_tr_form_1a ;
  v-wf:transformRule s-wf:rul_tr_form_a ;
  v-wf:transformRule s-wf:rul_tr_form_2 ;
  v-wf:transformRule s-wf:rul_tr_form_3 ;
  v-wf:transformRule s-wf:rul_tr_form_4 ;
  v-wf:transformRule s-wf:rul_tr_form_5 ;
  v-wf:transformRule s-wf:rul_tr_form_6 ;
  v-wf:transformRule s-wf:rul_tr_form_8 ;
  v-wf:transformRule s-wf:rul_tr_form_9 ;
  v-wf:transformRule s-wf:rul_tr_form_10 ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Трансформация создания пользовательской формы ответа на задачу"@ru ;
.

s-wf:rul_tr_form_1
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
# v-wf:aggregate  "putFieldOfIndividFromElement ('rdfs:label', 'rdfs:label')";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Варианты ответа"@ru ;
.

s-wf:rul_tr_form_1a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'decision_form_type')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('rdf:type')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Тип формы из переменной decision_form_type"@ru ;
.

s-wf:rul_tr_form_2
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'initiator')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValueFrom ('v-wf:from', ['v-s:occupation'])";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "От кого = инициатор"@ru ;
.

s-wf:rul_tr_form_3
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'coordinationLevel')" ;
  v-wf:segregateElement "elementContentStrValue('v-wf:variableValue', '1')" ;
  v-wf:aggregate  "putString ('rdfs:label', '1 уровень')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Определение согласования 1 уровень"@ru ;
.

s-wf:rul_tr_form_4
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'coordinationLevel')" ;
  v-wf:segregateElement "elementContentStrValue('v-wf:variableValue', '2')" ;
  v-wf:aggregate  "putString ('rdfs:label', '2 уровень')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Определение согласования 2 уровень"@ru ;
.

s-wf:rul_tr_form_5
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'coordinationLevel')" ;
  v-wf:segregateElement "elementContentStrValue('v-wf:variableValue', '3')" ;
  v-wf:aggregate  "putString ('rdfs:label', '3 уровень')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Определение согласования 3 уровень"@ru ;
.

s-wf:rul_tr_form_6
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'possible_decision')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:possibleDecisionClass')";
  v-wf:grouping "1";
  rdfs:label "Установить возможные варианты ответов"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_tr_form_a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'actor_task_action')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putFrontValue ('rdfs:label')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить rdfs:label из переменной actor_task_action"@ru ;
.

s-wf:rul_tr_form_8
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'actor_task_date_to')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:dateGiven')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить v-wf:dateGiven из переменной s-wf:var_actor_task_date_to"@ru ;
.

s-wf:rul_tr_form_9
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'actor_task_comment')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-s:description')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить v-s:description из переменной s-wf:var_actor_task_action"@ru ;
.

s-wf:rul_tr_form_10
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate "setDatetime ('v-s:created', new Date())" ;
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить дату выдачи задачи"@ru ;
.


# ------------- journal ------------------------

s-wf:var_journal_to
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:executor" ;
  rdfs:label "Кому"@ru ;
.

s-wf:var_journal_initiator
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:initiator" ;
  rdfs:label "Инициатор"@ru ;
.

s-wf:var_journal_comment
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdfs:comment" ;
  rdfs:label "Комментарий"@ru ;
.

s-wf:var_journal_msg
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdfs:label" ;
  rdfs:label "Сообщение"@ru ;
.

s-wf:var_journal_decision
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:takenDecision" ;
  rdfs:label "Решение"@ru ;
.

s-wf:var_journal_ev_type
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdf:type" ;
  rdfs:label "Тип события"@ru ;
.

s-wf:var_journal_doc_id
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-s:onDocument" ;
  rdfs:label "Ссылка на документ"@ru ;
.

s-wf:var_journal_process_id
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:onProcess" ;
  rdfs:label "Ссылка на процесс"@ru ;
.

s-wf:map_journal_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "order.getExecutor ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "process.getLocalVariable ('controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "process.getLocalVariable ('responsible')?process.getLocalVariable ('responsible'):process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_OOV_result_data_N_author
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "get_properties_chain (order.getOutVariable ('result_data'), [{$get:'v-s:author'}])" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_fc
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression  "process.getInputVariable ('financial_controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_msg_4_task_label_start
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression  "task.getLabel ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_msg_4_task_label_complete
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression  "task.getLabel ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_initiator ;
  v-wf:mappingExpression  "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_process_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_process_id ;
  v-wf:mappingExpression  "newUri (process.src_data['@'])" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_doc_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_doc_id ;
  v-wf:mappingExpression  "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:src_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "src_uri" ;
  rdfs:label "Документ-источник"@ru ;
.

s-wf:name_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "name_uri" ;
  rdfs:label "ID поля"@ru ;
.

s-wf:value
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "value" ;
  rdfs:label "Значение"@ru ;
.

s-wf:map_docID_to_src
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:src_uri ;
  v-wf:mappingExpression  "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

##########################################################################################################################################

s-wf:var_actor_task
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task" ;
  rdfs:label "Actor task" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_of_set_responsible_2_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task ;
  v-wf:mappingExpression  "process.getLocalVariable ('decision_of_set_responsible')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_actor_task_action
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_action" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task action" ;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:var_actor_task_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_comment" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task comment" ;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:var_actor_task_description
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_description" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task description" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_comment_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression
  """
  get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:description', $eq:{'v-s:responsible':process.getExecutor ()}}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_initiator_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression """
  get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:author', $eq:{'v-s:responsible':process.getExecutor ()}}]
              )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_actor_task_date_to_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression """
  get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:dateTo', $eq:{'v-s:responsible':process.getExecutor ()}}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_actor_task_description_from_LV_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_description ;
  v-wf:mappingExpression "get_properties_chain (process.getLocalVariable('result_decision'), [{$get:'rdfs:comment'}] )";
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.

s-wf:map_actor_task_action_4LV_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression """
  get_properties_chain (process.getLocalVariable('result_decision'),
                            [{$go:'rdf:type'}, {$get:'rdfs:label'}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.

s-wf:map_actor_task_action_return_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression """
  get_properties_chain (task_result.getValue ('result_data'),
                            [{$go:'rdf:type'}, {$get:'rdfs:label'}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.


s-wf:var_actor_task_date_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_date_to" ;
  rdfs:label "Actor_task_date_to" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_task_date_to_2_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression """

  get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:dateTo', $eq:{'v-s:responsible':process.getExecutor ()}}]
              )

  """;
  rdfs:label "Описание задачи из формы решения пользователя"@ru ;
.

s-wf:map_PI_actor_task_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task ;
  v-wf:mappingExpression  "process.getInputVariable ('actor_task')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_date_to_4_actor_task_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression
    """
    if (process.getInputVariable ('actor_task_add_to_date_to'))
        newDate (addDay (getFirstValue (process.getInputVariable ('actor_task_date_to')), getFirstValue (process.getInputVariable ('actor_task_add_to_date_to'))));
    else
        process.getInputVariable ('actor_task_date_to');
    """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_action_4_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression  "process.getInputVariable ('actor_task_action')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_comment_4_actor_task_comment
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression  "process.getInputVariable ('actor_task_comment')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor ;
  v-wf:mappingExpression """

  get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

s-wf:map_responsible_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_responsible ;
  v-wf:mappingExpression """

  get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

s-wf:map_controller_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_controller ;
  v-wf:mappingExpression """

  get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

##########################################################################################################################################


s-wf:transformation_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "transformation_uri" ;
  rdfs:label "Ссылка на трансформацию"@ru ;
.
#---------- Net Coordination

s-wf:def_exec_actor
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "get_properties_chain (process.getLocalVariable ('actor'), [{$get:'v-s:occupation'}], process.getLocalVariable ('actor'))" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_controller
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "get_properties_chain (process.getLocalVariable ('controller'), [{$get:'v-s:occupation'}], process.getLocalVariable ('controller'))" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_initiator
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_responsible
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getLocalVariable ('responsible')?process.getLocalVariable ('responsible'):process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_if_result
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression  "task_result.if_all_executors_taken_decision('v-wf:DecisionAgreed', 'v-wf:DecisionRemake')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_result_decision_from_TR_result_data
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression  "task_result.getValue ('result_data')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_task_description_from_TR_result_data
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_description ;
  v-wf:mappingExpression "get_properties_chain (task_result.getValue ('result_data'), [{$get:'rdfs:comment'}])";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_from_executor_or_PI_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor ;
  v-wf:mappingExpression
    """
        if (process.getInputVariable ('actor'))
            process.getInputVariable ('actor');
        else
            process.getExecutor ();
    """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_from_executor_or_PI_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_controller ;
  v-wf:mappingExpression
    """
        process.getInputVariable ('controller');
    """;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:map_set_add_request_actor_from_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_add_request_actor ;
  v-wf:mappingExpression  "process.getInputVariable ('initiator')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_jrn_msg_nc_t2_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "newStr ('Выдана задача: '+process.getLocalVariable ('actor_task_action')[0].data)" ;
.

s-wf:map_jrn_msg_nc_t2_b_remake
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "newStr ('Выдана задача: Доработать')" ;
.


s-wf:map_jrn_msg_nc_t2_b_ev
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_ev_type ;
  v-wf:mappingExpression "newUri ('v-wf:TaskGiven')" ;
.

s-wf:map_jrn_msg_nc_t2_comment
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_comment ;
  v-wf:mappingExpression "process.getLocalVariable ('actor_task_comment')" ;
.

s-wf:map_jrn_msg_nce_t2_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "newStr ('Получен ответ на задачу')" ;
.

s-wf:map_jrn_msg_nce_t2_b_ev
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_ev_type ;
  v-wf:mappingExpression "newUri ('v-wf:TaskCompleted')" ;
.

s-wf:map_jrn_decision_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_decision ;
  v-wf:mappingExpression "order.getOutVariable ('result_data')" ;
.

s-wf:net_coordination
  a v-wf:Net;
  rdfs:label "Универсальный маршрут 1"@ru;
  v-wf:consistsOf s-wf:nc_ic, s-wf:nc_t1, s-wf:nc_t2, s-wf:nc_t3, s-wf:nc_oc, s-wf:nc_f_ic_t1, s-wf:nc_f_t1_t2, s-wf:nc_f_t1_oc, s-wf:nc_f_t1_rti, s-wf:nc_f_t3_t1;
  v-wf:consistsOf s-wf:nc_return_to_initiator, s-wf:nc_r_to_aur, s-wf:nc_to_aur, s-wf:nc_finish, s-wf:nc_to_finish, s-wf:nc_f_t1_oc, s-wf:nc_f_t1_rti;
  v-wf:consistsOf s-wf:nc_f_t2_oc, s-wf:nc_f_t2_t1, s-wf:c1, d:abaa42215-965f-a032-aada-31be82a54e95, d:ac2ce1732-d914-c4f9-f4b6-2064864b3f23;
  v-wf:consistsOf s-wf:additional_user_response, d:a65787936-f51e-a83c-f537-95eaaa02c21a, d:afdd3ebd0-7934-8d38-1f68-158a05f0330d, d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e, d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_oc, d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_rti;
  v-wf:consistsOf d:a3d7c838c-df12-e9ec-48c6-a96f3bb7e13f, d:abc5142af-b501-1ec6-8ee0-acb767f078a4, d:abc5142af-b501-1ec6-8ee0-acb767f078a4_oc, d:abc5142af-b501-1ec6-8ee0-acb767f078a4_rti, d:a16bb1fd3-64eb-a7bb-501d-889b2aa4500d, d:aec10d9da-789d-fd65-a094-bd4ed7b14822;
  v-wf:consistsOf s-wf:nc_rti_rights, s-wf:nc_oc_rights, d:a8b89a22d-23b9-1c1c-c5dc-3443fd3972de, d:a8a52f5c1-84fb-0976-794a-5c66b93258e7, d:a74e1dea7-75e9-9d5f-b942-d1a7f2b91b2b, d:a6caa3c11-9333-4270-549f-e899df057223;
  v-wf:completedMapping s-wf:map_set_result_from_local, s-wf:map_set_result_decision_from_local, s-wf:map_last_actor_4_PLV_actor;
  v-wf:inputVariable s-wf:var_msg_template, s-wf:var_doc_id, s-wf:var_initiator, s-wf:var_coordinator, s-wf:var_coordinator_level, s-wf:var_rightset;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow/>;
  v-wf:localVariable s-wf:var_responsible, s-wf:var_result, s-wf:var_actor, s-wf:var_controller, s-wf:var_add_request_actor, s-wf:var_result_decision, s-wf:var_actor_task_date_to;
  v-wf:localVariable s-wf:var_actor_task_comment, s-wf:var_actor_task_action.

s-wf:c1 v-wf:hasFlow d:abaa42215-965f-a032-aada-31be82a54e95;
  v-wf:locationY "528"^^xsd:integer;
  a v-wf:Condition;
  rdfs:label "C1"@ru;
  v-wf:predicate "true"^^xsd:string;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-09T12:51:20.000Z"^^xsd:dateTime;
  v-wf:locationX "552"^^xsd:integer;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow-base/>.

d:abaa42215-965f-a032-aada-31be82a54e95 a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-09T12:51:20.156Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_t1.

d:a65787936-f51e-a83c-f537-95eaaa02c21a
  a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-09T12:51:20.163Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', task.getInputVariable ('decision_route_to_add_reaction')) == true"^^xsd:string;
  v-wf:flowsInto s-wf:additional_user_response.

d:afdd3ebd0-7934-8d38-1f68-158a05f0330d a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-09T12:51:20.166Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionBreak')) == false && task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionAchieved')) == false"^^xsd:string;
  v-wf:flowsInto s-wf:c1.

d:ac2ce1732-d914-c4f9-f4b6-2064864b3f23 a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-09T14:25:56.755Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionBreak')) == true"^^xsd:string;
  v-wf:flowsInto s-wf:nc_finish.

s-wf:map_set_result_from_local
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression  "process.getLocalVariable ('result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_last_actor_4_PLV_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_last_actor ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:m_result_f_out_var
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression  "task.getOutVariable ('result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_result_decision_from_local
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression  "process.getLocalVariable ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_now_plus_30_4_actor_task_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression  "newDate (addDay (new Date (), 30))";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:nc_ic v-wf:hasFlow s-wf:nc_f_ic_t1;
  v-wf:locationY "511"^^xsd:integer;
  a v-wf:InputCondition;
  rdfs:label "C1s"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:locationX "108"^^xsd:integer;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow/>.


s-wf:nc_t3
  v-wf:hasFlow s-wf:nc_f_t3_t1, d:aec10d9da-789d-fd65-a094-bd4ed7b14822;
  v-wf:join v-wf:None;
  v-wf:locationY "516"^^xsd:integer;
  a v-wf:Task;
  v-wf:executor s-wf:codelet_get_type_of_docId;
  v-wf:split v-wf:XOR;
  rdfs:label "Установить: actor = [исполнитель текущего процесса], actor_task_date_to, actor_task_action, actor_task_comment"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:completedMapping s-wf:map_set_actor_from_executor_or_PI_actor, s-wf:map_set_actor_from_executor_or_PI_controller, s-wf:map_PI_actor_task_date_to_4_actor_task_date_to, s-wf:map_PI_actor_task_action_4_actor_task_action;
  v-wf:completedMapping s-wf:map_PI_actor_task_comment_4_actor_task_comment, s-wf:map_initiator, s-wf:map_documentType;
  v-wf:locationX "248"^^xsd:integer.

d:aec10d9da-789d-fd65-a094-bd4ed7b14822 a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-17T11:54:51.991Z"^^xsd:dateTime;
  v-wf:predicate "process.getInputVariable ('actor_task') != undefined"^^xsd:string;
  v-wf:flowsInto d:a16bb1fd3-64eb-a7bb-501d-889b2aa4500d.

s-wf:nc_f_t3_t1 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:predicate "process.getInputVariable ('actor_task') == undefined"^^xsd:string;
  v-wf:flowsInto s-wf:c1;
.

d:a16bb1fd3-64eb-a7bb-501d-889b2aa4500d v-wf:hasFlow d:a8b89a22d-23b9-1c1c-c5dc-3443fd3972de;
  v-wf:locationY "388"^^xsd:integer;
  a v-wf:Task;
  rdfs:label "Установить параметры из переменной actor_task"^^xsd:string;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:completedMapping s-wf:map_actor_task_date_to_4_actor_task, s-wf:map_actor_task_comment_4_actor_task, s-wf:map_initiator_4_actor_task;
  v-s:created "2015-11-17T11:54:51.988Z"^^xsd:dateTime;
  v-wf:locationX "381"^^xsd:integer.

s-wf:nc_t1
  a v-wf:Task;
  rdfs:isDefinedBy s-wf: ;
  v-wf:locationX "660"^^xsd:integer;
  v-wf:locationY "515"^^xsd:integer;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:predicate "true"^^xsd:string;
  v-wf:hasFlow s-wf:nc_f_t1_t2;
  v-wf:executor s-wf:codelet_down_right;
  rdfs:label "Установить права"^^xsd:string;
  v-wf:split v-wf:XOR;
.

s-wf:nc_oc_rights
  a v-wf:Task;
  rdfs:isDefinedBy s-wf: ;
  v-wf:locationX "928"^^xsd:integer;
  v-wf:locationY "358"^^xsd:integer;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:predicate "true"^^xsd:string;
  v-wf:hasFlow s-wf:nc_f_t1_oc;
  v-wf:executor s-wf:codelet_change_controller_right;
  rdfs:label "Установить права"^^xsd:string;
  v-wf:split v-wf:XOR;
.

s-wf:nc_rti_rights
  a v-wf:Task;
  rdfs:isDefinedBy s-wf: ;
  v-wf:locationX "1050"^^xsd:integer;
  v-wf:locationY "657"^^xsd:integer;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:predicate "true"^^xsd:string;
  v-wf:hasFlow s-wf:nc_f_t1_rti;
  v-wf:executor s-wf:codelet_change_responsible_right;
  rdfs:label "Установить права"^^xsd:string;
  v-wf:split v-wf:XOR;
.

s-wf:nc_t2
  a v-wf:Task;
  v-wf:locationX "865"^^xsd:integer;
  v-wf:locationY "529"^^xsd:integer;
  v-wf:split v-wf:XOR;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:startDecisionTransform s-wf:tr_actor_form;
  v-wf:completeDecisionTransform s-wf:tr_taken_decision;
  v-wf:hasFlow s-wf:nc_f_t2_t1, s-wf:nc_f_t2_oc, d:a65787936-f51e-a83c-f537-95eaaa02c21a, s-wf:nc_t2_to_r;
  rdfs:label "Выдача задачи";
  v-wf:expectedResultType s-wf:UserTaskForm;
  v-wf:startingMapping s-wf:map_doc_id, s-wf:map_initiator_4_PLV_initiator, s-wf:map_coord_level, s-wf:map_t2_sm1, s-wf:map_t2_sm2, s-wf:map_t2_sm3;
  v-wf:startingMapping s-wf:map_possible_decision, s-wf:map_decision_route_to_add_reaction, s-wf:map_decision_form_type_4_PIV_decision_form_type;
  v-wf:startingMessageMap s-wf:map_msg_template_4_SV_default_template, s-wf:map_from_4_TIV_initiator, s-wf:map_document_4_TIV_docId, s-wf:map_vf_to_4_O_executor;
  v-wf:startingMessageMap s-wf:map_comment_4_TIV_actor_task_action, s-wf:map_comment_4_TIV_actor_task_comment, s-wf:map_rdf_type_4_TIV_documentType, s-wf:map_inbox_url_4_vedaInfo_appInboxUrl, s-wf:map_doc_url_4_vedaInfo_appUrl;
  v-wf:startingMessageMap s-wf:map_wf_from_4_TIV_initiator, s-wf:map_rdf_type_4_v_s_Email, s-wf:map_task_url_4_O_DecisionForms, s-wf:map_to_4_O_executor;
  v-wf:executor s-wf:def_exec_actor;
  v-wf:completedMapping s-wf:map_set_decision_from_local, s-wf:map_set_result_decision_from_TR_result_data, s-wf:map_t2_sm5;
  rdfs:isDefinedBy s-wf: ;
  v-wf:startingExecutorJournalMap s-wf:map_jrn_msg_nc_t2_b, s-wf:map_jrn_msg_nc_t2_b_ev, s-wf:map_journal_to_4_PLV_actor, s-wf:map_journal_doc_id, s-wf:map_journal_process_id, s-wf:map_jrn_msg_nc_t2_comment ;
  v-wf:completedExecutorJournalMap s-wf:map_jrn_msg_nce_t2_b, s-wf:map_jrn_msg_nce_t2_b_ev, s-wf:map_journal_to_4_OOV_result_data_N_author, s-wf:map_journal_doc_id, s-wf:map_journal_process_id, s-wf:map_jrn_decision_b ;
.

s-wf:nc_return_to_initiator
  a v-wf:Task;
  v-wf:locationX "1400"^^xsd:integer;
  v-wf:locationY "650"^^xsd:integer;
  v-wf:hasFlow s-wf:nc_r_to_i_return, s-wf:nc_r_to_i_finish, s-wf:nc_r_to_aur;
  rdfs:label "Обработка отказа"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:startDecisionTransform s-wf:tr_actor_form;
  v-wf:completeDecisionTransform s-wf:tr_taken_decision;
  v-wf:expectedResultType s-wf:UserTaskForm;
  v-wf:startingMapping s-wf:map_doc_id, s-wf:map_initiator_4_PLV_initiator, s-wf:map_coord_level, s-wf:map_t2_sm1, s-wf:map_actor_task_action_4LV_result_decision, s-wf:map_t2_sm3;
  v-wf:startingMapping s-wf:possible_decision_after_return, s-wf:map_decision_route_to_add_reaction, s-wf:map_decision_form_type_4_PIV_decision_form_type, s-wf:map_actor_task_description_from_LV_result_decision;
  v-wf:startingMessageMap s-wf:map_msg_template_4_SV_default_template, s-wf:map_from_4_TIV_initiator, s-wf:map_document_4_TIV_docId, s-wf:map_vf_to_4_O_executor;
  v-wf:startingMessageMap s-wf:map_comment_4_TIV_actor_task_action, s-wf:map_inbox_url_4_vedaInfo_appInboxUrl, s-wf:map_doc_url_4_vedaInfo_appUrl;
  v-wf:startingMessageMap s-wf:map_wf_from_4_TIV_initiator, s-wf:map_rdf_type_4_v_s_Email, s-wf:map_task_url_4_O_DecisionForms, s-wf:map_to_4_O_executor;
  v-wf:executor s-wf:def_exec_responsible;
  v-wf:completedMapping s-wf:map_set_decision_from_local, s-wf:map_set_result_decision_from_TR_result_data, s-wf:map_actor_task_action_return_result_decision, s-wf:map_set_actor_task_description_from_TR_result_data, s-wf:map_t2_sm5;
  rdfs:isDefinedBy s-wf: ;
  v-wf:startingExecutorJournalMap s-wf:map_jrn_msg_nc_t2_b, s-wf:map_jrn_msg_nc_t2_b_ev, s-wf:map_journal_to_4_PLV_responsible, s-wf:map_journal_doc_id, s-wf:map_journal_process_id ;
  v-wf:completedExecutorJournalMap s-wf:map_jrn_msg_nce_t2_b, s-wf:map_jrn_msg_nce_t2_b_ev, s-wf:map_journal_to_4_OOV_result_data_N_author, s-wf:map_journal_doc_id, s-wf:map_journal_process_id, s-wf:map_jrn_decision_b ;
.

s-wf:nc_oc
  a v-wf:Task;
  v-wf:locationX "1300"^^xsd:integer;
  v-wf:locationY "430"^^xsd:integer;
  v-wf:hasFlow s-wf:nc_to_finish, s-wf:nc_r_to_i_return, s-wf:nc_to_aur;
  rdfs:label "Контроль"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:startDecisionTransform s-wf:tr_actor_form;
  v-wf:completeDecisionTransform s-wf:tr_taken_decision;
  v-wf:expectedResultType s-wf:UserTaskForm;
  v-wf:startingMapping s-wf:map_doc_id, s-wf:map_initiator_4_PLV_initiator, s-wf:map_coord_level, s-wf:map_t2_sm1, s-wf:map_actor_task_action_4LV_result_decision, s-wf:map_t2_sm_control;
  v-wf:startingMapping s-wf:possible_decision_after_return, s-wf:map_decision_route_to_add_reaction, s-wf:map_decision_form_type_4_PIV_decision_form_type, s-wf:map_actor_task_description_from_LV_result_decision;
  v-wf:startingMessageMap s-wf:map_msg_template_4_SV_default_template, s-wf:map_from_4_TIV_initiator, s-wf:map_document_4_TIV_docId, s-wf:map_vf_to_4_O_executor;
  v-wf:startingMessageMap s-wf:map_comment_4_TIV_actor_task_action, s-wf:map_inbox_url_4_vedaInfo_appInboxUrl, s-wf:map_doc_url_4_vedaInfo_appUrl;
  v-wf:startingMessageMap s-wf:map_wf_from_4_TIV_initiator, s-wf:map_rdf_type_4_v_s_Email, s-wf:map_task_url_4_O_DecisionForms, s-wf:map_to_4_O_executor;
  v-wf:executor s-wf:def_exec_controller;
  v-wf:completedMapping s-wf:map_set_decision_from_local, s-wf:map_set_result_decision_from_TR_result_data, s-wf:map_actor_task_action_return_result_decision, s-wf:map_set_actor_task_description_from_TR_result_data, s-wf:map_t2_sm5;
  rdfs:isDefinedBy s-wf: ;
  v-wf:startingExecutorJournalMap s-wf:map_jrn_msg_nc_t2_b, s-wf:map_jrn_msg_nc_t2_b_ev, s-wf:map_journal_to_4_PLV_controller, s-wf:map_journal_doc_id, s-wf:map_journal_process_id ;
  v-wf:completedExecutorJournalMap s-wf:map_jrn_msg_nce_t2_b, s-wf:map_jrn_msg_nce_t2_b_ev, s-wf:map_journal_to_4_OOV_result_data_N_author, s-wf:map_journal_doc_id, s-wf:map_journal_process_id, s-wf:map_jrn_decision_b ;
.

s-wf:nc_r_to_i_return a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRemake')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t2;
.

s-wf:nc_r_to_i_finish a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionAgreed')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_finish;
.

s-wf:nc_r_to_aur a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4_rti;
.

s-wf:nc_to_finish a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "(!process.getInputVariable ('controller')) || task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionAgreed')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_finish;
.

s-wf:nc_to_aur a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4_oc;
.

s-wf:nc_t2_to_r a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRejected')) == true || task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionNotPerformed')) == true || task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionNotForMe')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_return_to_initiator;
.

s-wf:additional_user_response
  a v-wf:Task;
  v-wf:hasFlow d:afdd3ebd0-7934-8d38-1f68-158a05f0330d, d:ac2ce1732-d914-c4f9-f4b6-2064864b3f23, d:a74e1dea7-75e9-9d5f-b942-d1a7f2b91b2b;
  v-wf:split v-wf:XOR;
  v-wf:locationY "356"^^xsd:integer;
  v-wf:startDecisionTransform s-wf:tr_actor_add_request_form;
  v-wf:completeDecisionTransform s-wf:tr_taken_decision;
  v-wf:startingMapping s-wf:map_doc_id, s-wf:map_set_add_request_actor_from_initiator, s-wf:map_initiator_from_actor, s-wf:map_possible_decision_for_add_reaction;
  v-wf:startingMapping s-wf:map_actor_task_description_from_LV_result_decision, s-wf:map_decision_form_type_4_PIV_decision_form_type, s-wf:map_actor_task_action_4LV_result_decision;
  v-wf:completedMapping s-wf:map_set_decision_from_local, s-wf:map_set_result_decision_from_TR_result_data, s-wf:map_set_actor_task_description_from_TR_result_data;
  v-wf:completedMapping s-wf:map_actor_task_action_4_PIV_actor_task_action;
  rdfs:label "Дополнительная реакция"^^xsd:string;
  v-wf:executor s-wf:def_exec_initiator;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-09T12:51:20.000Z"^^xsd:dateTime;
  v-wf:locationX "630"^^xsd:integer;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow/>.

s-wf:map_set_decision_from_local
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression  "task_result.getValue ('result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm1
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor_task_date_to')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm2
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor_task_action')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm3
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression  "process.getLocalVariable ('actor_task_comment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm_control
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression  "newStr('Принять отчёт')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm5
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression  "get_properties_chain (task_result.getValue ('result_data'), [{$get:'rdfs:comment'}])";
  rdfs:isDefinedBy s-wf: ;
.


s-wf:nc_finish a v-wf:OutputCondition;
  v-wf:locationY "43"^^xsd:integer;
  v-wf:locationX "1514"^^xsd:integer;
  rdfs:label "C2c"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow/>.

s-wf:nc_f_ic_t1 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t3.

s-wf:nc_f_t1_t2 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t2.

s-wf:nc_f_t1_oc a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_oc.

s-wf:nc_f_t1_rti a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_return_to_initiator.

s-wf:nc_f_t2_oc a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:flowsInto s-wf:nc_oc_rights;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRedirect')) == false && task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRejected')) == false && task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionNotPerformed')) == false && task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionNotForMe')) == false && task_result.is_all_executors_taken_decision ('result', task.getInputVariable ('decision_route_to_add_reaction')) == false"^^xsd:string.

s-wf:nc_f_t2_t1 a v-wf:Flow;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow-base/>.

d:abc5142af-b501-1ec6-8ee0-acb767f078a4
  v-wf:hasFlow d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e;
  v-wf:locationY "637"^^xsd:integer;
  a v-wf:Task;
  rdfs:label "Установить переменную actor из *result_decision[wf:to]"^^xsd:string;
  v-wf:completedMapping s-wf:map_actor_2_result_decision;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-10T18:08:39.175Z"^^xsd:dateTime;
  v-wf:locationX "480"^^xsd:integer.

d:abc5142af-b501-1ec6-8ee0-acb767f078a4_oc
  v-wf:hasFlow d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_oc;
  v-wf:locationY "264"^^xsd:integer;
  a v-wf:Task;
  rdfs:label "Установить переменную controller из *result_decision[wf:to]"^^xsd:string;
  v-wf:completedMapping s-wf:map_controller_2_result_decision;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-10T18:08:39.175Z"^^xsd:dateTime;
  v-wf:locationX "1168"^^xsd:integer.

d:abc5142af-b501-1ec6-8ee0-acb767f078a4_rti
  v-wf:hasFlow d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_rti;
  v-wf:locationY "800"^^xsd:integer;
  a v-wf:Task;
  rdfs:label "Установить переменную responsible из *result_decision[wf:to]"^^xsd:string;
  v-wf:completedMapping s-wf:map_responsible_2_result_decision;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-10T18:08:39.175Z"^^xsd:dateTime;
  v-wf:locationX "1200"^^xsd:integer.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:c1.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_oc a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_oc_rights.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_rti a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_rti_rights.


d:a8b89a22d-23b9-1c1c-c5dc-3443fd3972de a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-17T11:54:51.993Z"^^xsd:dateTime;
  v-wf:predicate  "true";
  v-wf:flowsInto s-wf:c1.

d:a8a52f5c1-84fb-0976-794a-5c66b93258e7 a v-wf:Condition;
  v-wf:hasFlow d:a6caa3c11-9333-4270-549f-e899df057223;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-25T09:21:02.217Z"^^xsd:dateTime;
  rdfs:label "Нормальное завершение"^^xsd:string;
  v-wf:locationY "189"^^xsd:integer;
  v-wf:locationX "1322"^^xsd:integer.

d:a74e1dea7-75e9-9d5f-b942-d1a7f2b91b2b a v-wf:Flow;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', newUri ('v-wf:DecisionAchieved')) == true "^^xsd:string;
  v-s:author td:RomanKarpov-Analyst1;
  v-s:created "2015-11-25T09:21:02.220Z"^^xsd:dateTime;
  v-wf:flowsInto d:a8a52f5c1-84fb-0976-794a-5c66b93258e7.

d:a6caa3c11-9333-4270-549f-e899df057223 a v-wf:Flow;
  v-s:author td:RomanKarpov-Analyst1;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-25T09:21:02.222Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_oc.


#---- ---- -----

s-wf:ss1 a v-s:SavedSearch;
  rdfs:isDefinedBy s-wf: ;
  v-s:author td:RomanKarpov;
  v-s:query "'rdfs:isDefinedBy' == 's-wf:'"^^xsd:string;
  rdfs:label "Базовая онтология маршрутов монди"^^xsd:string;
  v-s:created "2015-05-23T13:27:18.000Z"^^xsd:dateTime.



# ----------- define vars for message template -------
s-wf:map_msg_template_4_SV_default_template
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_msg_template ;
  v-wf:mappingExpression  "process.getInputVariable('$template')?process.getInputVariable('$template'):newUri ('m-l:msg-template-universal')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_msg_template_4_SV_default_template_notification
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_msg_template ;
  v-wf:mappingExpression  "process.getInputVariable('$template')?process.getInputVariable('$template'):newUri ('m-l:msg-template-universal_notification')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_from_4_TIV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression  "task.getInputVariable ('initiator')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_wf_from_4_TIV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_from ;
  v-wf:mappingExpression  "newUri ('cfg:VedaSystemAppointment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_document_4_TIV_docId
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document ;
  v-wf:mappingExpression  "task.getInputVariable ('docId')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task ;
  v-wf:mappingExpression  "task.getInputVariable ('actor_task_action')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_rework
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task ;
  v-wf:mappingExpression  "newStr('Доработать')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_comment
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_comment ;
  v-wf:mappingExpression  "task.getInputVariable ('actor_task_comment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_rdf_type_4_TIV_documentType
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_rdf_type ;
  v-wf:mappingExpression  "task.getInputVariable ('documentType')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_inbox_url_4_vedaInfo_appInboxUrl
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_inbox_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  get_properties_chain (newUri ('v-s:vedaInfo'),
              [{$get:'v-wf:appInboxUrl'}])
  """;
.

s-wf:map_doc_url_4_vedaInfo_appUrl
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  newStr (getFirstValue (get_properties_chain (newUri ('v-s:vedaInfo'), [{$get:'v-s:appUrl'}])) + "/" + getFirstValue(task.getInputVariable ('docId')))
  """;
.

s-wf:map_msg_executor_informing
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression  "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_vf_to_4_O_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression  "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_to_4_O_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_to ;
  v-wf:mappingExpression  "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_task_url_4_O_DecisionForms
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task_url;
  v-wf:mappingExpression
  """
  newStr (getFirstValue (get_properties_chain (newUri ('v-s:vedaInfo'), [{$get:'v-s:appUrl'}])) + "/" + getFirstValue(order.getDecisionForms ()))
  """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_rdf_type_4_v_s_Email
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_rdf_type ;
  v-wf:mappingExpression  "newUri ('v-s:Email')";
  rdfs:isDefinedBy s-wf: ;
.

# # # # # # # # # # # # # # # # # # #

s-wf:var_msg_template
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "$template" ;
  rdfs:label "Var $template" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_document
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "document" ;
  rdfs:label "Var document" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_rdf_type
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "rdf:type" ;
  rdfs:label "Var rdf:type" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_from
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "from" ;
  rdfs:label "Var from" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "to" ;
  rdfs:label "Var to" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_wf_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "v-wf:to" ;
  rdfs:label "Var v-wf:to" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_wf_from
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "v-wf:from" ;
  rdfs:label "Var v-wf:from" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "comment" ;
  rdfs:label "Var comment" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_document_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "document_url" ;
  rdfs:label "Var document_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_task_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "task_url" ;
  rdfs:label "Var task_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_task
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "task" ;
  rdfs:label "Var task" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_inbox_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "inbox_url" ;
  rdfs:label "Var inbox_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:msg-default-template
  rdf:type v-s:TemplateForText ;
  v-s:templateLanguage v-ui:RU ;
  v-s:templateSubject "СЭД Задача: Исполнить поручение по документу: {{document}}" ;
  v-s:templateBody
  """
от пользователя: {{from}}, Вам поступило поручение по документу: {{document}}
Комментарий: {{comment}}.

Используйте ссылки для перехода на нужные страницы:

документ: {{document_url}}
задача: {{task_url}}
все входящие задачи: {{inbox_url}}
  """;
.

s-wf:map_currentNetToIsProcess_to_transformation
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:transformation_uri ;
  v-wf:mappingExpression  "newUri('s-wf:currentNetToIsProcess')" ;
  rdfs:label "добавление id процесса в поле документа"@ru ;
.

s-wf:currentNetToIsProcess
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rule1currentNetToIsProcess ;
  v-wf:transformRule s-wf:rule2currentNetToIsProcess ;
.
s-wf:rule1currentNetToIsProcess
  rdf:type v-wf:Rule ;
  v-wf:aggregate "putElement ()" ;
  v-wf:grouping "@", "1";
.
s-wf:rule2currentNetToIsProcess
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate  "putThisProcess ('v-wf:isProcess')";
  v-wf:grouping "@", "1";
.

s-wf:map_currentNetFromIsProcess_to_transformation
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:transformation_uri ;
  v-wf:mappingExpression  "newUri('s-wf:currentNetFromIsProcess')" ;
  rdfs:label "удаление id процесса из поля документа"@ru ;
.
s-wf:currentNetFromIsProcess
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rule1currentNetFromIsProcess ;
  v-wf:transformRule s-wf:rule2currentNetFromIsProcess ;
.
s-wf:rule1currentNetFromIsProcess
  rdf:type v-wf:Rule ;
  v-wf:aggregate "putElement ()" ;
  v-wf:grouping "@", "1";
.
s-wf:rule2currentNetFromIsProcess
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate  "removeThisProcess ('v-wf:isProcess')";
  v-wf:grouping "@", "1";
.

s-wf:complexRouteTransform
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:complexRouteRule ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:complexRouteRule
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate "putValue ('v-wf:processedDocument')" ;
  v-wf:aggregate "putUri ('v-wf:forNet', 's-wf:net_complex_route')" ;
  v-wf:aggregate "putUri ('rdf:type', 's-wf:ComplexRouteStartForm')" ;
  v-wf:aggregate "putUri ('v-wf:useTransformation', 's-wf:complexRouteStartFormToNet')" ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:grouping "1";
.


