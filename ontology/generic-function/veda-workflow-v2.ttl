@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix v-s: <http://semantic-machines.com/veda/veda-schema/> .
@prefix v-wf2: <http://semantic-machines.com/veda/veda-workflow2/> .

# =============================================================================
# VEDA WORKFLOW ONTOLOGY v2.0
# =============================================================================
# Uses prefix v-wf2: to allow parallel operation with legacy v-wf: engine.
#
# Key changes from v1 (v-wf:):
# - Variables stored as JSON inside Process/WorkItem (not separate objects)
# - Mappings use JSONPath + YAML syntax (not JavaScript expressions)
# - Transforms are declarative (not imperative JS code)
# - States are enums (not boolean flags)
# - Events are declarative triggers (no embedded scripts)
# - UI templates moved to separate file
# - Added versioning, timeouts, compensation support
#
# Migration: Documents can be processed by either engine based on their type:
# - v-wf:Process  → processed by legacy workflow engine (scripts-v8)
# - v-wf2:Process → processed by new workflow engine (veda-workflow2)
# =============================================================================

<http://semantic-machines.com/veda/veda-workflow2>
  rdf:type owl:Ontology ;
  rdfs:isDefinedBy v-wf2: ;
  owl:versionInfo "2.0" ;
  rdfs:label "Veda Workflow Ontology v2"@en ;
  rdfs:label "Онтология потоков работ Veda v2"@ru ;
  rdfs:comment "Redesigned workflow ontology with simplified variables and mappings. Uses v-wf2: prefix for parallel operation with legacy v-wf: engine."@en ;
  v-s:loadPriority 8 ;
.


# =============================================================================
# PART 1: WORKFLOW SCHEMA (Design-time)
# =============================================================================
# These classes define the workflow structure (template/blueprint).
# They are created once and reused for multiple process instances.
# =============================================================================

# -----------------------------------------------------------------------------
# Net - Workflow Definition
# -----------------------------------------------------------------------------

v-wf2:Net
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:Versioned ;
  rdfs:label "Workflow Net"@en ;
  rdfs:label "Сеть маршрута"@ru ;
  rdfs:comment "A workflow definition based on Petri net model. Contains tasks, conditions, and flows."@en ;
.

v-wf2:netVersion
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Net ;
  rdfs:range xsd:integer ;
  rdfs:label "Version number"@en ;
  rdfs:comment "Incremented when net structure changes. Processes reference specific version."@en ;
.

v-wf2:consistsOf
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Net ;
  rdfs:range v-wf2:NetElement ;
  rdfs:label "Consists of"@en ;
  rdfs:comment "Elements that make up this net (tasks, conditions, flows)"@en ;
.

v-wf2:inputCondition
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Net ;
  rdfs:range v-wf2:Condition ;
  rdfs:label "Input condition"@en ;
  rdfs:comment "The single entry point of the net (exactly one per net)"@en ;
.

v-wf2:outputCondition
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Net ;
  rdfs:range v-wf2:Condition ;
  rdfs:label "Output condition"@en ;
  rdfs:comment "The single exit point of the net (exactly one per net)"@en ;
.

v-wf2:variableSchema
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Net ;
  rdfs:range xsd:string ;
  rdfs:label "Variable schema"@en ;
  rdfs:comment "JSON Schema defining expected variables with types and defaults"@en ;
.

# Example:
# ex:myNet v-wf2:variableSchema """
#   {
#     "docId": {"type": "uri", "required": true},
#     "amount": {"type": "decimal", "default": 0},
#     "approvers": {"type": "array", "items": {"type": "uri"}}
#   }
# """^^xsd:string .

# -----------------------------------------------------------------------------
# NetElement - Base class for net components
# -----------------------------------------------------------------------------

v-wf2:NetElement
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Net Element"@en ;
  rdfs:comment "Base class for all elements within a workflow net"@en ;
.

v-wf2:belongsTo
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:NetElement ;
  rdfs:range v-wf2:Net ;
  rdfs:label "Belongs to"@en ;
  rdfs:comment "The net this element is part of"@en ;
.

v-wf2:position
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:NetElement ;
  rdfs:range xsd:string ;
  rdfs:label "Visual position"@en ;
  rdfs:comment "Position for visual editor: {\"x\": 100, \"y\": 200}"@en ;
.

# -----------------------------------------------------------------------------
# Condition - Places in Petri net
# -----------------------------------------------------------------------------

v-wf2:Condition
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf2:NetElement ;
  rdfs:label "Condition"@en ;
  rdfs:label "Условие"@ru ;
  rdfs:comment "A place/condition in the Petri net. Tokens reside here between tasks."@en ;
.

v-wf2:ConditionType
  rdf:type owl:Class ;
  rdfs:label "Condition Type"@en ;
.

v-wf2:InputConditionType
  rdf:type v-wf2:ConditionType ;
  rdfs:label "Input"@en ;
.

v-wf2:OutputConditionType
  rdf:type v-wf2:ConditionType ;
  rdfs:label "Output"@en ;
.

v-wf2:IntermediateConditionType
  rdf:type v-wf2:ConditionType ;
  rdfs:label "Intermediate"@en ;
.

v-wf2:conditionType
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Condition ;
  rdfs:range v-wf2:ConditionType ;
  rdfs:label "Condition type"@en ;
.

# -----------------------------------------------------------------------------
# Task - Transitions in Petri net
# -----------------------------------------------------------------------------

v-wf2:Task
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf2:NetElement ;
  rdfs:label "Task"@en ;
  rdfs:label "Задача"@ru ;
  rdfs:comment "A task/transition in the workflow. Can be manual (user) or automatic (codelet/subprocess)."@en ;
.

v-wf2:TaskType
  rdf:type owl:Class ;
  rdfs:label "Task Type"@en ;
.

v-wf2:ManualTask
  rdf:type v-wf2:TaskType ;
  rdfs:label "Manual Task"@en ;
  rdfs:comment "Requires human decision via DecisionForm"@en ;
.

v-wf2:AutomaticTask
  rdf:type v-wf2:TaskType ;
  rdfs:label "Automatic Task"@en ;
  rdfs:comment "Executed by codelet without human intervention"@en ;
.

v-wf2:SubprocessTask
  rdf:type v-wf2:TaskType ;
  rdfs:label "Subprocess Task"@en ;
  rdfs:comment "Spawns a child process from another Net"@en ;
.

v-wf2:taskType
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:TaskType ;
  rdfs:label "Task type"@en ;
.

# -----------------------------------------------------------------------------
# Split/Join patterns
# -----------------------------------------------------------------------------

v-wf2:SplitType
  rdf:type owl:Class ;
  rdfs:label "Split Type"@en ;
.

v-wf2:AndSplit
  rdf:type v-wf2:SplitType ;
  rdfs:label "AND-split"@en ;
  rdfs:comment "All outgoing flows are activated (parallel)"@en ;
.

v-wf2:XorSplit
  rdf:type v-wf2:SplitType ;
  rdfs:label "XOR-split"@en ;
  rdfs:comment "Exactly one outgoing flow is activated (exclusive choice)"@en ;
.

v-wf2:OrSplit
  rdf:type v-wf2:SplitType ;
  rdfs:label "OR-split"@en ;
  rdfs:comment "One or more outgoing flows are activated (inclusive choice)"@en ;
.

v-wf2:JoinType
  rdf:type owl:Class ;
  rdfs:label "Join Type"@en ;
.

v-wf2:AndJoin
  rdf:type v-wf2:JoinType ;
  rdfs:label "AND-join"@en ;
  rdfs:comment "Wait for all incoming flows (synchronization)"@en ;
.

v-wf2:XorJoin
  rdf:type v-wf2:JoinType ;
  rdfs:label "XOR-join"@en ;
  rdfs:comment "Activated when any one incoming flow arrives (merge)"@en ;
.

v-wf2:OrJoin
  rdf:type v-wf2:JoinType ;
  rdfs:label "OR-join"@en ;
  rdfs:comment "Wait for all active incoming flows (synchronizing merge)"@en ;
.

v-wf2:splitType
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:SplitType ;
  rdfs:label "Split type"@en ;
.

v-wf2:joinType
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:JoinType ;
  rdfs:label "Join type"@en ;
.

# -----------------------------------------------------------------------------
# Flow - Arcs connecting elements
# -----------------------------------------------------------------------------

v-wf2:Flow
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf2:NetElement ;
  rdfs:label "Flow"@en ;
  rdfs:label "Поток"@ru ;
  rdfs:comment "An arc connecting a condition to a task or a task to a condition"@en ;
.

v-wf2:flowFrom
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Flow ;
  rdfs:range v-wf2:NetElement ;
  rdfs:label "Flow from"@en ;
  rdfs:comment "Source element of the flow"@en ;
.

v-wf2:flowTo
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Flow ;
  rdfs:range v-wf2:NetElement ;
  rdfs:label "Flow to"@en ;
  rdfs:comment "Target element of the flow"@en ;
.

v-wf2:guard
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Flow ;
  rdfs:range xsd:string ;
  rdfs:label "Guard condition"@en ;
  rdfs:comment "JSONPath expression that must evaluate to true for flow to be taken"@en ;
.

# Example guards:
# "$.vars.amount > 1000"                         - amount exceeds threshold
# "$.vars.decision == 'approved'"                - specific decision
# "$.vars.approvers.length > 0"                  - array not empty
# "$.document['v-s:hasStatus'] == 'v-s:Active'"  - document status check

v-wf2:priority
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Flow ;
  rdfs:range xsd:integer ;
  rdfs:label "Priority"@en ;
  rdfs:comment "For XOR-split: flows are evaluated in priority order, first true wins"@en ;
.

v-wf2:isDefault
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Flow ;
  rdfs:range xsd:boolean ;
  rdfs:label "Is default flow"@en ;
  rdfs:comment "For XOR-split: taken if no other guards are satisfied"@en ;
.

# -----------------------------------------------------------------------------
# Task Configuration
# -----------------------------------------------------------------------------

# Executor definition
v-wf2:executor
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-s:Appointment, v-s:Position, v-s:Person, v-wf2:ExecutorExpression, v-s:Codelet ;
  rdfs:label "Executor"@en ;
  rdfs:comment "Who/what executes this task. Can be direct reference or expression."@en ;
.

v-wf2:ExecutorExpression
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Executor Expression"@en ;
  rdfs:comment "Dynamic executor resolution via JSONPath expression"@en ;
.

v-wf2:executorPath
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:ExecutorExpression ;
  rdfs:range xsd:string ;
  rdfs:label "Executor path"@en ;
.

# Example:
# ex:docAuthorExecutor a v-wf2:ExecutorExpression ;
#   v-wf2:executorPath "$.document['v-s:creator']" .
#
# ex:managersExecutor a v-wf2:ExecutorExpression ;
#   v-wf2:executorPath "$.vars.approversList[*]" .

# Subprocess configuration
v-wf2:subprocess
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:Net ;
  rdfs:label "Subprocess"@en ;
  rdfs:comment "Child net to instantiate (for SubprocessTask)"@en ;
.

v-wf2:multiInstance
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:boolean ;
  rdfs:label "Multi-instance"@en ;
  rdfs:comment "If true, creates separate work item for each executor"@en ;
.

v-wf2:multiInstanceCollection
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Multi-instance collection"@en ;
  rdfs:comment "JSONPath to array - creates work item for each element"@en ;
.

# Example: "$.vars.reviewers" - creates work item for each reviewer

# -----------------------------------------------------------------------------
# Timeouts and Deadlines
# -----------------------------------------------------------------------------

v-wf2:timeout
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Timeout"@en ;
  rdfs:comment "Maximum time allowed for task completion (ISO 8601 duration)"@en ;
.

v-wf2:reminder
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Reminder interval"@en ;
  rdfs:comment "Send reminder after this duration if task not completed"@en ;
.

v-wf2:TimeoutAction
  rdf:type owl:Class ;
  rdfs:label "Timeout Action"@en ;
.

v-wf2:EscalateAction
  rdf:type v-wf2:TimeoutAction ;
  rdfs:label "Escalate"@en ;
.

v-wf2:AutoCompleteAction
  rdf:type v-wf2:TimeoutAction ;
  rdfs:label "Auto-complete"@en ;
.

v-wf2:CancelAction
  rdf:type v-wf2:TimeoutAction ;
  rdfs:label "Cancel"@en ;
.

v-wf2:onTimeout
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:TimeoutAction ;
  rdfs:label "On timeout"@en ;
.

v-wf2:escalateTo
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-s:Appointment, v-wf2:ExecutorExpression ;
  rdfs:label "Escalate to"@en ;
  rdfs:comment "Executor to escalate to on timeout"@en ;
.

# -----------------------------------------------------------------------------
# MAPPINGS - Simplified Data Transformation
# -----------------------------------------------------------------------------
# Instead of separate Mapping objects, we use inline YAML with JSONPath.
# Format: "targetVar: $.source.path" or "targetVar: literal value"
# -----------------------------------------------------------------------------

v-wf2:inputMapping
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Input mapping"@en ;
  rdfs:comment "Maps data INTO task variables when task starts"@en ;
.

# Example:
# ex:approvalTask v-wf2:inputMapping """
#   docId: $.document['@']
#   docTitle: $.document['rdfs:label'][0].data
#   amount: $.document['v-s:amount'][0].data
#   requestor: $.document['v-s:creator'][0].data
#   previousDecision: $.vars.decision
# """^^xsd:string .

v-wf2:outputMapping
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Output mapping"@en ;
  rdfs:comment "Maps task results back to process variables when task completes"@en ;
.

# Example:
# ex:approvalTask v-wf2:outputMapping """
#   decision: $.result.decision
#   comment: $.result.comment
#   approvedBy: $.executor
#   approvedAt: $now
# """^^xsd:string .

# Special variables available in mappings:
# $.document    - the document being processed
# $.vars        - current process variables
# $.result      - task completion result (for outputMapping)
# $.executor    - current task executor
# $.task        - current task definition
# $.process     - current process instance
# $now          - current datetime
# $user         - current user
# $genUri       - generate new URI

# -----------------------------------------------------------------------------
# TRANSFORMS - For Creating New Objects
# -----------------------------------------------------------------------------
# Used when task needs to create objects (e.g., DecisionForm).
# Declarative: specify source→target field mappings.
# -----------------------------------------------------------------------------

v-wf2:Transform
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Transform"@en ;
  rdfs:comment "Declarative transformation for creating new objects"@en ;
.

v-wf2:targetType
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Transform ;
  rdfs:range owl:Class ;
  rdfs:label "Target type"@en ;
  rdfs:comment "RDF type of objects to create"@en ;
.

v-wf2:fieldMapping
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Transform ;
  rdfs:range xsd:string ;
  rdfs:label "Field mapping"@en ;
  rdfs:comment "YAML mapping from context to target object fields"@en ;
.

# Example - Transform to create DecisionForm:
# ex:createDecisionForm a v-wf2:Transform ;
#   v-wf2:targetType v-wf2:DecisionForm ;
#   v-wf2:fieldMapping """
#     '@': $genUri
#     'rdf:type': v-wf2:DecisionForm
#     'v-wf2:onDocument': $.vars.docId
#     'v-wf2:to': $.executor
#     'v-wf2:from': $.vars.initiator
#     'rdfs:label': "Review: {{$.document['rdfs:label']}}"
#     'v-s:created': $now
#     'v-s:creator': cfg:VedaSystem
#   """^^xsd:string .

v-wf2:createTransform
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:Transform ;
  rdfs:label "Create transform"@en ;
  rdfs:comment "Transform to create objects when task starts (e.g., DecisionForm)"@en ;
.

v-wf2:completeTransform
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:Transform ;
  rdfs:label "Complete transform"@en ;
  rdfs:comment "Transform to create/update objects when task completes"@en ;
.

# -----------------------------------------------------------------------------
# Decision Options
# -----------------------------------------------------------------------------

v-wf2:DecisionOption
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:Classified ;
  rdfs:label "Decision Option"@en ;
  rdfs:comment "Possible decision that user can take"@en ;
.

v-wf2:Approve
  rdf:type v-wf2:DecisionOption ;
  rdfs:label "Approve"@en ;
  rdfs:label "Согласовано"@ru ;
.

v-wf2:Reject
  rdf:type v-wf2:DecisionOption ;
  rdfs:label "Reject"@en ;
  rdfs:label "Отклонено"@ru ;
.

v-wf2:Rework
  rdf:type v-wf2:DecisionOption ;
  rdfs:label "Send for rework"@en ;
  rdfs:label "На доработку"@ru ;
.

v-wf2:Cancel
  rdf:type v-wf2:DecisionOption ;
  rdfs:label "Cancel"@en ;
  rdfs:label "Отменить"@ru ;
.

v-wf2:decisionOptions
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:DecisionOption ;
  rdfs:label "Decision options"@en ;
  rdfs:comment "Available decisions for manual task"@en ;
.

# =============================================================================
# PART 2: WORKFLOW INSTANCE (Runtime)
# =============================================================================
# These classes represent running workflow instances.
# Created dynamically when workflow is started.
# =============================================================================

# -----------------------------------------------------------------------------
# Process - Running workflow instance
# -----------------------------------------------------------------------------

v-wf2:Process
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Process"@en ;
  rdfs:label "Процесс"@ru ;
  rdfs:comment "A running instance of a workflow Net"@en ;
.

v-wf2:ProcessState
  rdf:type owl:Class ;
  rdfs:label "Process State"@en ;
.

v-wf2:ProcessCreated
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Created"@en ;
.

v-wf2:ProcessRunning
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Running"@en ;
.

v-wf2:ProcessCompleted
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Completed"@en ;
.

v-wf2:ProcessCancelled
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Cancelled"@en ;
.

v-wf2:ProcessSuspended
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Suspended"@en ;
.

v-wf2:ProcessFailed
  rdf:type v-wf2:ProcessState ;
  rdfs:label "Failed"@en ;
.

v-wf2:processState
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-wf2:ProcessState ;
  rdfs:label "Process state"@en ;
.

v-wf2:instanceOf
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-wf2:Net ;
  rdfs:label "Instance of"@en ;
  rdfs:comment "The Net definition this process was created from"@en ;
.

v-wf2:netVersionUsed
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range xsd:integer ;
  rdfs:label "Net version used"@en ;
  rdfs:comment "Version of the Net at the time process was started"@en ;
.

# IMPORTANT: Variables stored as JSON, not separate objects!
v-wf2:variables
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process, v-wf2:WorkItem ;
  rdfs:range xsd:string ;
  rdfs:label "Variables"@en ;
  rdfs:comment "All process/task variables as a single JSON object"@en ;
.

# Example:
# ex:process1 v-wf2:variables """
#   {
#     "docId": "d:document123",
#     "initiator": "d:user1",
#     "amount": 50000,
#     "approvers": ["d:manager1", "d:director1"],
#     "decisions": [
#       {"by": "d:manager1", "decision": "approved", "at": "2024-01-15T10:30:00Z"}
#     ]
#   }
# """^^xsd:string .

v-wf2:document
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-s:Thing ;
  rdfs:label "Document"@en ;
  rdfs:comment "The main document being processed by this workflow"@en ;
.

v-wf2:initiator
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-s:Appointment ;
  rdfs:label "Initiator"@en ;
  rdfs:comment "Who started this process"@en ;
.

v-wf2:parentProcess
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-wf2:Process ;
  rdfs:label "Parent process"@en ;
  rdfs:comment "Parent process if this is a subprocess"@en ;
.

v-wf2:parentWorkItem
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range v-wf2:WorkItem ;
  rdfs:label "Parent work item"@en ;
  rdfs:comment "Work item that spawned this subprocess"@en ;
.

v-wf2:startedAt
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process, v-wf2:WorkItem ;
  rdfs:range xsd:dateTime ;
  rdfs:label "Started at"@en ;
.

v-wf2:completedAt
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process, v-wf2:WorkItem ;
  rdfs:range xsd:dateTime ;
  rdfs:label "Completed at"@en ;
.

v-wf2:error
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process, v-wf2:WorkItem ;
  rdfs:range xsd:string ;
  rdfs:label "Error"@en ;
  rdfs:comment "Error message if process/task failed"@en ;
.

# -----------------------------------------------------------------------------
# WorkItem - Task execution instance
# -----------------------------------------------------------------------------

v-wf2:WorkItem
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Work Item"@en ;
  rdfs:label "Рабочий элемент"@ru ;
  rdfs:comment "An instance of a Task being executed within a Process"@en ;
.

v-wf2:WorkItemState
  rdf:type owl:Class ;
  rdfs:label "Work Item State"@en ;
.

v-wf2:WorkItemEnabled
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Enabled"@en ;
  rdfs:comment "Ready to execute (all preconditions met)"@en ;
.

v-wf2:WorkItemRunning
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Running"@en ;
  rdfs:comment "Currently being executed"@en ;
.

v-wf2:WorkItemCompleted
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Completed"@en ;
.

v-wf2:WorkItemCancelled
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Cancelled"@en ;
.

v-wf2:WorkItemFailed
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Failed"@en ;
.

v-wf2:WorkItemTimedOut
  rdf:type v-wf2:WorkItemState ;
  rdfs:label "Timed out"@en ;
.

v-wf2:workItemState
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-wf2:WorkItemState ;
  rdfs:label "State"@en ;
.

v-wf2:forProcess
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-wf2:Process ;
  rdfs:label "For process"@en ;
.

v-wf2:forTask
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-wf2:Task ;
  rdfs:label "For task"@en ;
  rdfs:comment "The Task definition this work item executes"@en ;
.

v-wf2:assignee
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-s:Appointment ;
  rdfs:label "Assignee"@en ;
  rdfs:comment "The actual person/appointment assigned to this work item"@en ;
.

v-wf2:result
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range xsd:string ;
  rdfs:label "Result"@en ;
  rdfs:comment "Task execution result as JSON"@en ;
.

# Example result:
# ex:workItem1 v-wf2:result """
#   {
#     "decision": "approved",
#     "comment": "Looks good",
#     "completedBy": "d:manager1"
#   }
# """^^xsd:string .

v-wf2:dueDate
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range xsd:dateTime ;
  rdfs:label "Due date"@en ;
  rdfs:comment "Calculated deadline for this work item"@en ;
.

v-wf2:reminderSentAt
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range xsd:dateTime ;
  rdfs:label "Reminder sent at"@en ;
.

v-wf2:previousWorkItem
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-wf2:WorkItem ;
  rdfs:label "Previous work item"@en ;
  rdfs:comment "For tracing execution path"@en ;
.

v-wf2:childProcess
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:WorkItem ;
  rdfs:range v-wf2:Process ;
  rdfs:label "Child process"@en ;
  rdfs:comment "Subprocess spawned by this work item (for SubprocessTask)"@en ;
.

# -----------------------------------------------------------------------------
# DecisionForm - User task interface
# -----------------------------------------------------------------------------

v-wf2:DecisionForm
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:UserThing ;
  rdfs:label "Decision Form"@en ;
  rdfs:label "Форма решения"@ru ;
  rdfs:comment "Form presented to user for making a decision"@en ;
.

v-wf2:forWorkItem
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-wf2:WorkItem ;
  rdfs:label "For work item"@en ;
.

v-wf2:onDocument
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-s:Thing ;
  rdfs:label "On document"@en ;
.

v-wf2:to
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-s:Appointment ;
  rdfs:label "To"@en ;
  rdfs:comment "Recipient of the task"@en ;
.

v-wf2:from
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-s:Appointment ;
  rdfs:label "From"@en ;
  rdfs:comment "Sender/initiator"@en ;
.

v-wf2:takenDecision
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-wf2:DecisionOption ;
  rdfs:label "Taken decision"@en ;
.

v-wf2:decisionComment
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range xsd:string ;
  rdfs:label "Comment"@en ;
.

v-wf2:formData
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range xsd:string ;
  rdfs:label "Form data"@en ;
  rdfs:comment "Additional form fields as JSON"@en ;
.

v-wf2:decisionFormState
  rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:domain v-wf2:DecisionForm ;
  rdfs:range v-wf2:DecisionFormState ;
  rdfs:label "State"@en ;
.

v-wf2:DecisionFormState
  rdf:type owl:Class ;
  rdfs:label "Decision Form State"@en ;
.

v-wf2:DecisionFormPending
  rdf:type v-wf2:DecisionFormState ;
  rdfs:label "Pending"@en ;
.

v-wf2:DecisionFormCompleted
  rdf:type v-wf2:DecisionFormState ;
  rdfs:label "Completed"@en ;
.

v-wf2:DecisionFormCancelled
  rdf:type v-wf2:DecisionFormState ;
  rdfs:label "Cancelled"@en ;
.

# =============================================================================
# PART 3: WORKFLOW TRIGGER
# =============================================================================

v-wf2:WorkflowTrigger
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Workflow Trigger"@en ;
  rdfs:comment "Defines when and how to start a workflow"@en ;
.

v-wf2:triggerNet
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:WorkflowTrigger ;
  rdfs:range v-wf2:Net ;
  rdfs:label "Net to start"@en ;
.

v-wf2:triggerOnType
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:WorkflowTrigger ;
  rdfs:range owl:Class ;
  rdfs:label "Trigger on type"@en ;
  rdfs:comment "Start workflow when document of this type is created/updated"@en ;
.

v-wf2:triggerCondition
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:WorkflowTrigger ;
  rdfs:range xsd:string ;
  rdfs:label "Trigger condition"@en ;
  rdfs:comment "JSONPath condition that must be true to start workflow"@en ;
.

# Example:
# ex:approvalTrigger a v-wf2:WorkflowTrigger ;
#   v-wf2:triggerNet ex:approvalNet ;
#   v-wf2:triggerOnType v-s:Contract ;
#   v-wf2:triggerCondition "$.document['v-s:hasStatus'] == 'v-s:PendingApproval'" ;
#   v-wf2:initialMapping """
#     docId: $.document['@']
#     amount: $.document['v-s:amount'][0].data
#   """^^xsd:string .

v-wf2:initialMapping
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:WorkflowTrigger ;
  rdfs:range xsd:string ;
  rdfs:label "Initial mapping"@en ;
  rdfs:comment "Maps document data to initial process variables"@en ;
.

# =============================================================================
# PART 4: DOCUMENT STATUS
# =============================================================================

v-wf2:WorkflowStatus
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:Classified ;
  rdfs:label "Workflow Status"@en ;
.

v-wf2:StatusPending
  rdf:type v-wf2:WorkflowStatus ;
  rdfs:label "Pending"@en ;
  rdfs:label "Ожидает"@ru ;
.

v-wf2:StatusInProgress
  rdf:type v-wf2:WorkflowStatus ;
  rdfs:label "In Progress"@en ;
  rdfs:label "В работе"@ru ;
.

v-wf2:StatusCompleted
  rdf:type v-wf2:WorkflowStatus ;
  rdfs:label "Completed"@en ;
  rdfs:label "Завершено"@ru ;
.

v-wf2:StatusCancelled
  rdf:type v-wf2:WorkflowStatus ;
  rdfs:label "Cancelled"@en ;
  rdfs:label "Отменено"@ru ;
.

v-wf2:hasWorkflowStatus
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-s:Thing ;
  rdfs:range v-wf2:WorkflowStatus ;
  rdfs:label "Workflow status"@en ;
.

v-wf2:activeProcess
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-s:Thing ;
  rdfs:range v-wf2:Process ;
  rdfs:label "Active process"@en ;
  rdfs:comment "Currently running workflow process for this document"@en ;
.

# =============================================================================
# PART 5: HISTORY AND AUDIT
# =============================================================================
# Instead of separate JournalRecord objects, use JSON array in Process
# =============================================================================

v-wf2:history
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range xsd:string ;
  rdfs:label "History"@en ;
  rdfs:comment "Array of history events as JSON"@en ;
.

# Example:
# ex:process1 v-wf2:history """
#   [
#     {"event": "ProcessStarted", "at": "2024-01-15T09:00:00Z", "by": "d:user1"},
#     {"event": "TaskStarted", "task": "ex:reviewTask", "at": "2024-01-15T09:00:01Z"},
#     {"event": "TaskAssigned", "task": "ex:reviewTask", "to": "d:manager1", "at": "2024-01-15T09:00:02Z"},
#     {"event": "TaskCompleted", "task": "ex:reviewTask", "decision": "approved", "at": "2024-01-15T10:30:00Z", "by": "d:manager1"},
#     {"event": "ProcessCompleted", "at": "2024-01-15T10:30:01Z"}
#   ]
# """^^xsd:string .

v-wf2:traceEnabled
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range xsd:boolean ;
  rdfs:label "Trace enabled"@en ;
  rdfs:comment "If true, detailed execution trace is recorded"@en ;
.

v-wf2:trace
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Process ;
  rdfs:range xsd:string ;
  rdfs:label "Execution trace"@en ;
  rdfs:comment "Detailed trace for debugging (only if traceEnabled)"@en ;
.

# =============================================================================
# PART 6: COMPENSATION (Saga Pattern Support)
# =============================================================================

v-wf2:compensatingTask
  rdf:type owl:ObjectProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range v-wf2:Task ;
  rdfs:label "Compensating task"@en ;
  rdfs:comment "Task to execute for rollback if process is cancelled after this task completed"@en ;
.

v-wf2:compensationMapping
  rdf:type owl:DatatypeProperty ;
  rdfs:domain v-wf2:Task ;
  rdfs:range xsd:string ;
  rdfs:label "Compensation mapping"@en ;
  rdfs:comment "Data mapping for compensation task"@en ;
.

# =============================================================================
# END OF ONTOLOGY
# =============================================================================
